2025-07-18 09:47:40,288 - root - INFO - 正在初始化RAG服务...
2025-07-18 09:47:40,288 - app.core.rag_engine - INFO - Loading embedding model: sentence-transformers/all-MiniLM-L6-v2
2025-07-18 09:47:44,475 - sentence_transformers.SentenceTransformer - INFO - Load pretrained SentenceTransformer: sentence-transformers/all-MiniLM-L6-v2
2025-07-18 09:47:50,726 - app.core.rag_engine - INFO - 嵌入模型加载成功: sentence-transformers/all-MiniLM-L6-v2
2025-07-18 09:47:50,821 - httpx - INFO - HTTP Request: GET http://localhost:6333 "HTTP/1.1 200 OK"
2025-07-18 09:47:50,829 - httpx - INFO - HTTP Request: GET http://localhost:6333/collections "HTTP/1.1 200 OK"
2025-07-18 09:47:50,830 - app.core.vector_store - INFO - 向量存储初始化成功: qdrant
2025-07-18 09:47:50,830 - app.core.rag_engine - INFO - 向量存储初始化成功
2025-07-18 09:47:50,830 - app.core.rag_engine - INFO - LLM提供者初始化成功
2025-07-18 09:47:50,830 - app.core.rag_engine - INFO - Java后端客户端初始化成功: http://localhost:8080
2025-07-18 09:47:50,876 - app.core.llm_provider - INFO - Successfully initialized Qwen LLM with model: qwen-turbo
2025-07-18 09:47:50,876 - app.core.rag_engine - INFO - QA链创建成功
2025-07-18 09:47:50,876 - app.core.rag_engine - INFO - RAG引擎初始化完全成功
2025-07-18 09:47:50,876 - root - INFO - RAG服务初始化完成!
2025-07-18 10:06:30,627 - root - INFO - 正在关闭RAG服务...
2025-07-18 10:06:30,630 - app.core.vector_store - INFO - 向量存储资源清理完成
2025-07-18 10:06:30,630 - root - INFO - RAG服务已关闭!
2025-07-18 10:06:38,683 - root - INFO - 正在初始化RAG服务...
2025-07-18 10:06:38,683 - app.core.rag_engine - INFO - Loading embedding model: sentence-transformers/all-MiniLM-L6-v2
2025-07-18 10:06:42,067 - sentence_transformers.SentenceTransformer - INFO - Load pretrained SentenceTransformer: sentence-transformers/all-MiniLM-L6-v2
2025-07-18 10:06:48,646 - app.core.rag_engine - INFO - 嵌入模型加载成功: sentence-transformers/all-MiniLM-L6-v2
2025-07-18 10:06:48,725 - httpx - INFO - HTTP Request: GET http://localhost:6333 "HTTP/1.1 200 OK"
2025-07-18 10:06:48,736 - httpx - INFO - HTTP Request: GET http://localhost:6333/collections "HTTP/1.1 200 OK"
2025-07-18 10:06:48,738 - app.core.vector_store - INFO - 向量存储初始化成功: qdrant
2025-07-18 10:06:48,738 - app.core.rag_engine - INFO - 向量存储初始化成功
2025-07-18 10:06:48,738 - app.core.rag_engine - INFO - LLM提供者初始化成功
2025-07-18 10:06:48,738 - app.core.rag_engine - INFO - Java后端客户端初始化成功: http://localhost:8080
2025-07-18 10:06:48,785 - app.core.llm_provider - INFO - Successfully initialized Qwen LLM with model: qwen-turbo
2025-07-18 10:06:48,786 - app.core.rag_engine - INFO - QA链创建成功
2025-07-18 10:06:48,786 - app.core.rag_engine - INFO - RAG引擎初始化完全成功
2025-07-18 10:06:48,786 - root - INFO - RAG引擎已成功设置到chat模块
2025-07-18 10:06:48,786 - root - INFO - RAG服务初始化完成并已设置到chat模块!
2025-07-18 10:07:17,604 - app.api.documents - INFO - Extracting PDF content for paper 1: Attention Is All You Need
2025-07-18 10:07:17,604 - app.api.documents - ERROR - Error extracting PDF content: 'RAGEngine' object has no attribute 'vector_store'
Traceback (most recent call last):
  File "/Users/zhuolifeng/SE-Project/SE25Project-18-backend/python-rag-service/app/api/documents.py", line 142, in extract_pdf_content
    pdf_extractor = get_pdf_extractor(rag_engine.vector_store)
AttributeError: 'RAGEngine' object has no attribute 'vector_store'
2025-07-18 10:10:39,949 - root - INFO - 正在关闭RAG服务...
2025-07-18 10:10:39,951 - app.core.vector_store - INFO - 向量存储资源清理完成
2025-07-18 10:10:39,951 - root - INFO - RAG服务已关闭!
2025-07-18 10:10:44,585 - root - INFO - 正在初始化RAG服务...
2025-07-18 10:10:44,585 - app.core.rag_engine - INFO - Loading embedding model: sentence-transformers/all-MiniLM-L6-v2
2025-07-18 10:10:47,694 - sentence_transformers.SentenceTransformer - INFO - Load pretrained SentenceTransformer: sentence-transformers/all-MiniLM-L6-v2
2025-07-18 10:10:54,076 - app.core.rag_engine - INFO - 嵌入模型加载成功: sentence-transformers/all-MiniLM-L6-v2
2025-07-18 10:10:54,156 - httpx - INFO - HTTP Request: GET http://localhost:6333 "HTTP/1.1 200 OK"
2025-07-18 10:10:54,167 - httpx - INFO - HTTP Request: GET http://localhost:6333/collections "HTTP/1.1 200 OK"
2025-07-18 10:10:54,174 - app.core.vector_store - INFO - 向量存储初始化成功: qdrant
2025-07-18 10:10:54,174 - app.core.rag_engine - INFO - 向量存储初始化成功
2025-07-18 10:10:54,174 - app.core.rag_engine - INFO - LLM提供者初始化成功
2025-07-18 10:10:54,174 - app.core.rag_engine - INFO - Java后端客户端初始化成功: http://localhost:8080
2025-07-18 10:10:54,231 - app.core.llm_provider - INFO - Successfully initialized Qwen LLM with model: qwen-turbo
2025-07-18 10:10:54,231 - app.core.rag_engine - INFO - QA链创建成功
2025-07-18 10:10:54,231 - app.core.rag_engine - INFO - RAG引擎初始化完全成功
2025-07-18 10:10:54,231 - root - INFO - RAG引擎已成功设置到chat模块
2025-07-18 10:10:54,231 - root - INFO - RAG服务初始化完成并已设置到chat模块!
2025-07-18 10:26:16,631 - root - INFO - 正在初始化RAG服务...
2025-07-18 10:26:16,631 - app.core.rag_engine - INFO - Loading embedding model: sentence-transformers/all-MiniLM-L6-v2
2025-07-18 10:26:20,016 - sentence_transformers.SentenceTransformer - INFO - Load pretrained SentenceTransformer: sentence-transformers/all-MiniLM-L6-v2
2025-07-18 10:26:26,253 - app.core.rag_engine - INFO - 嵌入模型加载成功: sentence-transformers/all-MiniLM-L6-v2
2025-07-18 10:26:26,353 - httpx - INFO - HTTP Request: GET http://localhost:6333 "HTTP/1.1 200 OK"
2025-07-18 10:26:26,361 - httpx - INFO - HTTP Request: GET http://localhost:6333/collections "HTTP/1.1 200 OK"
2025-07-18 10:26:26,363 - app.core.vector_store - INFO - 向量存储初始化成功: qdrant
2025-07-18 10:26:26,363 - app.core.rag_engine - INFO - 向量存储初始化成功
2025-07-18 10:26:26,363 - app.core.rag_engine - INFO - LLM提供者初始化成功
2025-07-18 10:26:26,363 - app.core.rag_engine - INFO - Java后端客户端初始化成功: http://localhost:8080
2025-07-18 10:26:26,408 - app.core.llm_provider - INFO - Successfully initialized Qwen LLM with model: qwen-turbo
2025-07-18 10:26:26,409 - app.core.rag_engine - INFO - QA链创建成功
2025-07-18 10:26:26,409 - app.core.rag_engine - INFO - RAG引擎初始化完全成功
2025-07-18 10:26:26,409 - root - INFO - RAG引擎已成功设置到chat模块
2025-07-18 10:26:26,409 - root - INFO - RAG服务初始化完成并已设置到chat模块!
2025-07-18 10:52:38,780 - app.api.chat - INFO - Processing query: 这篇论文提出了什么核心创新？...
2025-07-18 10:52:38,785 - root - INFO - 处理查询 - 用户ID: 2, 论文ID: 1, 会话ID: test-conv-1
2025-07-18 10:52:38,785 - root - INFO - 查询问题: 这篇论文提出了什么核心创新？
2025-07-18 10:52:38,785 - root - INFO - 应用论文过滤器，论文ID: 1
2025-07-18 10:52:38,785 - root - INFO - 开始向量检索
2025-07-18 10:52:38,786 - root - INFO - Searching for documents with query: 这篇论文提出了什么核心创新？... (k=5)
2025-07-18 10:52:38,786 - root - INFO - Applying filter: {'metadata.paper_id': '1'}
2025-07-18 10:52:39,212 - httpx - INFO - HTTP Request: POST http://localhost:6333/collections/papers/points/search "HTTP/1.1 200 OK"
2025-07-18 10:52:39,221 - root - INFO - Found 0 matching documents
2025-07-18 10:52:39,221 - root - WARNING - 使用主过滤器没有找到文档，尝试备用字段
2025-07-18 10:52:39,221 - root - INFO - Searching for documents with query: 这篇论文提出了什么核心创新？... (k=5)
2025-07-18 10:52:39,221 - root - INFO - Applying filter: {'metadata.paperId': '1'}
2025-07-18 10:52:39,271 - httpx - INFO - HTTP Request: POST http://localhost:6333/collections/papers/points/search "HTTP/1.1 200 OK"
2025-07-18 10:52:39,271 - root - INFO - Found 0 matching documents
2025-07-18 10:52:39,272 - root - INFO - Searching for documents with query: 这篇论文提出了什么核心创新？... (k=5)
2025-07-18 10:52:39,272 - root - INFO - Applying filter: {'metadata.paper_title': {'$eq': '1'}}
2025-07-18 10:52:39,272 - app.core.vector_store - ERROR - Qdrant搜索失败: 3 validation errors for MatchValue
value.bool
  Input should be a valid boolean [type=bool_type, input_value={'$eq': '1'}, input_type=dict]
    For further information visit https://errors.pydantic.dev/2.11/v/bool_type
value.int
  Input should be a valid integer [type=int_type, input_value={'$eq': '1'}, input_type=dict]
    For further information visit https://errors.pydantic.dev/2.11/v/int_type
value.str
  Input should be a valid string [type=string_type, input_value={'$eq': '1'}, input_type=dict]
    For further information visit https://errors.pydantic.dev/2.11/v/string_type
2025-07-18 10:52:39,272 - root - INFO - Found 0 matching documents
2025-07-18 10:52:39,272 - root - INFO - Searching for documents with query: 这篇论文提出了什么核心创新？... (k=5)
2025-07-18 10:52:39,272 - root - INFO - Applying filter: {'metadata.paperID': '1'}
2025-07-18 10:52:39,294 - httpx - INFO - HTTP Request: POST http://localhost:6333/collections/papers/points/search "HTTP/1.1 200 OK"
2025-07-18 10:52:39,295 - root - INFO - Found 0 matching documents
2025-07-18 10:52:39,295 - root - INFO - 向量检索完成，耗时: 0.51秒，找到文档数: 0
2025-07-18 10:52:39,295 - root - WARNING - 没有找到相关文档！
2025-07-18 10:52:39,295 - root - INFO - 开始LLM查询生成
2025-07-18 10:52:39,305 - root - ERROR - 查询处理时出错: 'NoneType' object has no attribute 'ainvoke'
Traceback (most recent call last):
  File "/Users/zhuolifeng/SE-Project/SE25Project-18-backend/python-rag-service/app/core/rag_engine.py", line 313, in query
    chain_result = await qa_chain.ainvoke({
AttributeError: 'NoneType' object has no attribute 'ainvoke'
2025-07-18 10:57:34,411 - app.api.documents - INFO - Extracting PDF content for paper 1: Attention Is All You Need
2025-07-18 10:57:34,413 - root - INFO - PyPDF2库可用
2025-07-18 10:57:34,413 - root - INFO - pdfplumber库可用
2025-07-18 10:57:34,413 - root - INFO - Initialized PDFExtractor with chunk_size=1000, overlap=200
2025-07-18 10:57:34,413 - root - INFO - 开始处理PDF - URL: https://arxiv.org/pdf/1706.03762.pdf, 论文ID: 1, 标题: Attention Is All You Need
2025-07-18 10:57:34,413 - root - INFO - Searching for documents with query: paper_id_1... (k=1)
2025-07-18 10:57:34,413 - root - INFO - Special case - searching by paper_id: 1
2025-07-18 10:57:34,413 - root - INFO - Applying filter: {'paper_id': 1}
2025-07-18 10:57:34,475 - httpx - INFO - HTTP Request: POST http://localhost:6333/collections/papers/points/search "HTTP/1.1 200 OK"
2025-07-18 10:57:34,476 - root - INFO - Found 0 matching documents
2025-07-18 10:57:34,476 - root - INFO - 开始下载PDF: https://arxiv.org/pdf/1706.03762.pdf
2025-07-18 10:57:37,462 - root - INFO - PDF验证通过，开始提取文本
2025-07-18 10:57:39,457 - app.services.pdf_extractor - INFO - 使用pdfplumber成功提取了15页内容
2025-07-18 10:57:39,457 - app.services.pdf_extractor - INFO - 使用pdfplumber成功提取文本
2025-07-18 10:57:39,458 - root - INFO - 成功提取文本，大小: 35770 字符
2025-07-18 10:57:39,458 - app.services.pdf_extractor - INFO - 文本清理：原长度35756字符，清理后35756字符
2025-07-18 10:57:39,459 - app.services.pdf_extractor - INFO - 文本分割成45个块
2025-07-18 10:57:39,459 - root - INFO - 文本已分割成 45 个块
2025-07-18 10:57:39,459 - root - INFO - 开始将 45 个文本块存储到向量数据库
2025-07-18 10:57:39,459 - root - INFO - 准备存储 45 个文档到向量数据库
2025-07-18 10:57:40,439 - httpx - INFO - HTTP Request: PUT http://localhost:6333/collections/papers/points?wait=true "HTTP/1.1 200 OK"
2025-07-18 10:57:40,441 - app.core.vector_store - INFO - 成功添加 45 个文档到向量存储
2025-07-18 10:57:40,441 - root - INFO - 成功添加 45 个文档到向量数据库，返回的ID: ['fbce05f6935442e6a5cd486534156a5d', '770e172337cf45f58330914fb524686a', '28e2510e50c54696ba2a2755c7b52025']...
2025-07-18 10:57:40,441 - root - INFO - 成功存储 45 个块到向量数据库，论文ID: 1
2025-07-18 10:58:17,421 - app.api.chat - INFO - Processing query: 这篇论文提出了什么核心创新？...
2025-07-18 10:58:17,422 - root - INFO - 处理查询 - 用户ID: 2, 论文ID: 1, 会话ID: test-conv-1
2025-07-18 10:58:17,422 - root - INFO - 查询问题: 这篇论文提出了什么核心创新？
2025-07-18 10:58:17,422 - root - INFO - 应用论文过滤器，论文ID: 1
2025-07-18 10:58:17,422 - root - INFO - 开始向量检索
2025-07-18 10:58:17,422 - root - INFO - Searching for documents with query: 这篇论文提出了什么核心创新？... (k=5)
2025-07-18 10:58:17,422 - root - INFO - Applying filter: {'metadata.paper_id': '1'}
2025-07-18 10:58:17,479 - httpx - INFO - HTTP Request: POST http://localhost:6333/collections/papers/points/search "HTTP/1.1 200 OK"
2025-07-18 10:58:17,479 - root - INFO - Found 0 matching documents
2025-07-18 10:58:17,480 - root - WARNING - 使用主过滤器没有找到文档，尝试备用字段
2025-07-18 10:58:17,480 - root - INFO - Searching for documents with query: 这篇论文提出了什么核心创新？... (k=5)
2025-07-18 10:58:17,480 - root - INFO - Applying filter: {'metadata.paperId': '1'}
2025-07-18 10:58:17,504 - httpx - INFO - HTTP Request: POST http://localhost:6333/collections/papers/points/search "HTTP/1.1 200 OK"
2025-07-18 10:58:17,505 - root - INFO - Found 0 matching documents
2025-07-18 10:58:17,505 - root - INFO - Searching for documents with query: 这篇论文提出了什么核心创新？... (k=5)
2025-07-18 10:58:17,505 - root - INFO - Applying filter: {'metadata.paper_title': {'$eq': '1'}}
2025-07-18 10:58:17,505 - app.core.vector_store - ERROR - Qdrant搜索失败: 3 validation errors for MatchValue
value.bool
  Input should be a valid boolean [type=bool_type, input_value={'$eq': '1'}, input_type=dict]
    For further information visit https://errors.pydantic.dev/2.11/v/bool_type
value.int
  Input should be a valid integer [type=int_type, input_value={'$eq': '1'}, input_type=dict]
    For further information visit https://errors.pydantic.dev/2.11/v/int_type
value.str
  Input should be a valid string [type=string_type, input_value={'$eq': '1'}, input_type=dict]
    For further information visit https://errors.pydantic.dev/2.11/v/string_type
2025-07-18 10:58:17,505 - root - INFO - Found 0 matching documents
2025-07-18 10:58:17,505 - root - INFO - Searching for documents with query: 这篇论文提出了什么核心创新？... (k=5)
2025-07-18 10:58:17,505 - root - INFO - Applying filter: {'metadata.paperID': '1'}
2025-07-18 10:58:17,521 - httpx - INFO - HTTP Request: POST http://localhost:6333/collections/papers/points/search "HTTP/1.1 200 OK"
2025-07-18 10:58:17,522 - root - INFO - Found 0 matching documents
2025-07-18 10:58:17,522 - root - INFO - 向量检索完成，耗时: 0.10秒，找到文档数: 0
2025-07-18 10:58:17,522 - root - WARNING - 没有找到相关文档！
2025-07-18 10:58:17,522 - root - INFO - 开始LLM查询生成
2025-07-18 10:58:17,523 - root - ERROR - 查询处理时出错: 'NoneType' object has no attribute 'ainvoke'
Traceback (most recent call last):
  File "/Users/zhuolifeng/SE-Project/SE25Project-18-backend/python-rag-service/app/core/rag_engine.py", line 313, in query
    chain_result = await qa_chain.ainvoke({
AttributeError: 'NoneType' object has no attribute 'ainvoke'
2025-07-18 11:02:20,667 - root - INFO - 正在关闭RAG服务...
2025-07-18 11:02:20,670 - app.core.vector_store - INFO - 向量存储资源清理完成
2025-07-18 11:02:20,670 - root - INFO - RAG服务已关闭!
2025-07-18 11:02:24,992 - root - INFO - 正在初始化RAG服务...
2025-07-18 11:02:24,992 - app.core.rag_engine - INFO - Loading embedding model: sentence-transformers/all-MiniLM-L6-v2
2025-07-18 11:02:28,312 - sentence_transformers.SentenceTransformer - INFO - Load pretrained SentenceTransformer: sentence-transformers/all-MiniLM-L6-v2
2025-07-18 11:02:34,736 - app.core.rag_engine - INFO - 嵌入模型加载成功: sentence-transformers/all-MiniLM-L6-v2
2025-07-18 11:02:34,816 - httpx - INFO - HTTP Request: GET http://localhost:6333 "HTTP/1.1 200 OK"
2025-07-18 11:02:34,828 - httpx - INFO - HTTP Request: GET http://localhost:6333/collections "HTTP/1.1 200 OK"
2025-07-18 11:02:34,840 - app.core.vector_store - INFO - 向量存储初始化成功: qdrant
2025-07-18 11:02:34,840 - app.core.rag_engine - INFO - 向量存储初始化成功
2025-07-18 11:02:34,840 - app.core.rag_engine - INFO - LLM提供者初始化成功
2025-07-18 11:02:34,840 - app.core.rag_engine - INFO - Java后端客户端初始化成功: http://localhost:8080
2025-07-18 11:02:34,884 - app.core.llm_provider - INFO - Successfully initialized Qwen LLM with model: qwen-turbo
2025-07-18 11:02:34,885 - app.core.rag_engine - INFO - QA链创建成功
2025-07-18 11:02:34,885 - app.core.rag_engine - INFO - RAG引擎初始化完全成功
2025-07-18 11:02:34,885 - root - INFO - RAG引擎已成功设置到chat模块
2025-07-18 11:02:34,885 - root - INFO - RAG服务初始化完成并已设置到chat模块!
2025-07-18 11:02:52,384 - app.api.documents - INFO - Extracting PDF content for paper 1: Attention Is All You Need
2025-07-18 11:02:52,384 - root - INFO - PyPDF2库可用
2025-07-18 11:02:52,384 - root - INFO - pdfplumber库可用
2025-07-18 11:02:52,384 - root - INFO - Initialized PDFExtractor with chunk_size=1000, overlap=200
2025-07-18 11:02:52,384 - root - INFO - 开始处理PDF - URL: https://arxiv.org/pdf/1706.03762.pdf, 论文ID: 1, 标题: Attention Is All You Need
2025-07-18 11:02:52,384 - root - INFO - Searching for documents with query: paper_id_1... (k=1)
2025-07-18 11:02:52,384 - root - INFO - Special case - searching by paper_id: 1
2025-07-18 11:02:52,384 - root - INFO - Applying filter: {'paper_id': 1}
2025-07-18 11:02:52,536 - httpx - INFO - HTTP Request: POST http://localhost:6333/collections/papers/points/search "HTTP/1.1 200 OK"
2025-07-18 11:02:52,537 - root - INFO - Found 0 matching documents
2025-07-18 11:02:52,537 - root - INFO - 开始下载PDF: https://arxiv.org/pdf/1706.03762.pdf
2025-07-18 11:02:55,534 - root - INFO - PDF验证通过，开始提取文本
2025-07-18 11:02:57,049 - app.services.pdf_extractor - INFO - 使用pdfplumber成功提取了15页内容
2025-07-18 11:02:57,050 - app.services.pdf_extractor - INFO - 使用pdfplumber成功提取文本
2025-07-18 11:02:57,050 - root - INFO - 成功提取文本，大小: 35770 字符
2025-07-18 11:02:57,050 - app.services.pdf_extractor - INFO - 文本清理：原长度35756字符，清理后35756字符
2025-07-18 11:02:57,051 - app.services.pdf_extractor - INFO - 文本分割成45个块
2025-07-18 11:02:57,051 - root - INFO - 文本已分割成 45 个块
2025-07-18 11:02:57,051 - root - INFO - 开始将 45 个文本块存储到向量数据库
2025-07-18 11:02:57,051 - root - INFO - 准备存储 45 个文档到向量数据库
2025-07-18 11:02:57,905 - httpx - INFO - HTTP Request: PUT http://localhost:6333/collections/papers/points?wait=true "HTTP/1.1 200 OK"
2025-07-18 11:02:57,906 - app.core.vector_store - INFO - 成功添加 45 个文档到向量存储
2025-07-18 11:02:57,906 - root - INFO - 成功添加 45 个文档到向量数据库，返回的ID: ['3f5cce5a95fc4fc99a8269eaa05990be', '6b0fcc0e51c24b599ef5b0519c13bb2a', '2e010273b6d140b688a03d7fa009008b']...
2025-07-18 11:02:57,906 - root - INFO - 成功存储 45 个块到向量数据库，论文ID: 1
2025-07-18 11:03:11,244 - app.api.chat - INFO - Processing query: 这篇论文提出了什么核心创新？...
2025-07-18 11:03:11,244 - root - INFO - 处理查询 - 用户ID: 2, 论文ID: 1, 会话ID: test-conv-1
2025-07-18 11:03:11,244 - root - INFO - 查询问题: 这篇论文提出了什么核心创新？
2025-07-18 11:03:11,244 - root - INFO - 应用论文过滤器，论文ID: 1
2025-07-18 11:03:11,244 - root - INFO - 开始向量检索
2025-07-18 11:03:11,245 - root - INFO - Searching for documents with query: 这篇论文提出了什么核心创新？... (k=5)
2025-07-18 11:03:11,245 - root - INFO - Applying filter: {'paper_id': '1'}
2025-07-18 11:03:11,280 - httpx - INFO - HTTP Request: POST http://localhost:6333/collections/papers/points/search "HTTP/1.1 200 OK"
2025-07-18 11:03:11,282 - root - INFO - Found 5 matching documents
2025-07-18 11:03:11,282 - root - INFO - 向量检索完成，耗时: 0.04秒，找到文档数: 5
2025-07-18 11:03:11,282 - root - INFO - 开始LLM查询生成
2025-07-18 11:03:11,283 - root - ERROR - 查询处理时出错: 'NoneType' object has no attribute 'ainvoke'
Traceback (most recent call last):
  File "/Users/zhuolifeng/SE-Project/SE25Project-18-backend/python-rag-service/app/core/rag_engine.py", line 313, in query
    chain_result = await qa_chain.ainvoke({
AttributeError: 'NoneType' object has no attribute 'ainvoke'
2025-07-18 11:07:05,933 - root - INFO - 正在关闭RAG服务...
2025-07-18 11:07:05,935 - app.core.vector_store - INFO - 向量存储资源清理完成
2025-07-18 11:07:05,936 - root - INFO - RAG服务已关闭!
2025-07-18 11:07:10,018 - root - INFO - 正在初始化RAG服务...
2025-07-18 11:07:10,018 - app.core.rag_engine - INFO - Loading embedding model: sentence-transformers/all-MiniLM-L6-v2
2025-07-18 11:07:13,308 - sentence_transformers.SentenceTransformer - INFO - Load pretrained SentenceTransformer: sentence-transformers/all-MiniLM-L6-v2
2025-07-18 11:07:19,510 - app.core.rag_engine - INFO - 嵌入模型加载成功: sentence-transformers/all-MiniLM-L6-v2
2025-07-18 11:07:19,609 - httpx - INFO - HTTP Request: GET http://localhost:6333 "HTTP/1.1 200 OK"
2025-07-18 11:07:19,618 - httpx - INFO - HTTP Request: GET http://localhost:6333/collections "HTTP/1.1 200 OK"
2025-07-18 11:07:19,631 - app.core.vector_store - INFO - 向量存储初始化成功: qdrant
2025-07-18 11:07:19,631 - app.core.rag_engine - INFO - 向量存储初始化成功
2025-07-18 11:07:19,631 - app.core.rag_engine - INFO - LLM提供者初始化成功
2025-07-18 11:07:19,631 - app.core.rag_engine - INFO - Java后端客户端初始化成功: http://localhost:8080
2025-07-18 11:07:19,675 - app.core.llm_provider - INFO - Successfully initialized Qwen LLM with model: qwen-turbo
2025-07-18 11:07:19,675 - app.core.rag_engine - INFO - QA链创建成功
2025-07-18 11:07:19,675 - app.core.rag_engine - INFO - RAG引擎初始化完全成功
2025-07-18 11:07:19,675 - root - INFO - RAG引擎已成功设置到chat模块
2025-07-18 11:07:19,675 - root - INFO - RAG服务初始化完成并已设置到chat模块!
2025-07-18 11:10:25,197 - app.api.documents - INFO - Extracting PDF content for paper 1: Attention Is All You Need
2025-07-18 11:10:25,197 - root - INFO - PyPDF2库可用
2025-07-18 11:10:25,197 - root - INFO - pdfplumber库可用
2025-07-18 11:10:25,197 - root - INFO - Initialized PDFExtractor with chunk_size=1000, overlap=200
2025-07-18 11:10:25,197 - root - INFO - 开始处理PDF - URL: https://arxiv.org/pdf/1706.03762.pdf, 论文ID: 1, 标题: Attention Is All You Need
2025-07-18 11:10:25,197 - root - INFO - Searching for documents with query: paper_id_1... (k=1)
2025-07-18 11:10:25,197 - root - INFO - Special case - searching by paper_id: 1
2025-07-18 11:10:25,197 - root - INFO - Applying filter: {'paper_id': 1}
2025-07-18 11:10:25,240 - httpx - INFO - HTTP Request: POST http://localhost:6333/collections/papers/points/search "HTTP/1.1 200 OK"
2025-07-18 11:10:25,241 - root - INFO - Found 0 matching documents
2025-07-18 11:10:25,241 - root - INFO - 开始下载PDF: https://arxiv.org/pdf/1706.03762.pdf
2025-07-18 11:10:28,352 - root - INFO - PDF验证通过，开始提取文本
2025-07-18 11:10:29,882 - app.services.pdf_extractor - INFO - 使用pdfplumber成功提取了15页内容
2025-07-18 11:10:29,882 - app.services.pdf_extractor - INFO - 使用pdfplumber成功提取文本
2025-07-18 11:10:29,882 - root - INFO - 成功提取文本，大小: 35770 字符
2025-07-18 11:10:29,883 - app.services.pdf_extractor - INFO - 文本清理：原长度35756字符，清理后35756字符
2025-07-18 11:10:29,884 - app.services.pdf_extractor - INFO - 文本分割成45个块
2025-07-18 11:10:29,884 - root - INFO - 文本已分割成 45 个块
2025-07-18 11:10:29,884 - root - INFO - 开始将 45 个文本块存储到向量数据库
2025-07-18 11:10:29,884 - root - INFO - 准备存储 45 个文档到向量数据库
2025-07-18 11:10:30,740 - httpx - INFO - HTTP Request: PUT http://localhost:6333/collections/papers/points?wait=true "HTTP/1.1 200 OK"
2025-07-18 11:10:30,741 - app.core.vector_store - INFO - 成功添加 45 个文档到向量存储
2025-07-18 11:10:30,741 - root - INFO - 成功添加 45 个文档到向量数据库，返回的ID: ['1592cb5aa929483a88cc078498b2b97e', '726f59ec03a84d7ba13f7ceedccea9e9', 'deca518d612c476fb7b85daf94d9bdbd']...
2025-07-18 11:10:30,741 - root - INFO - 成功存储 45 个块到向量数据库，论文ID: 1
2025-07-18 11:10:41,148 - app.api.chat - INFO - Processing query: 这篇论文提出了什么核心创新？...
2025-07-18 11:10:41,148 - root - INFO - 处理查询 - 用户ID: 2, 论文ID: 1, 会话ID: test-conv-1
2025-07-18 11:10:41,148 - root - INFO - 查询问题: 这篇论文提出了什么核心创新？
2025-07-18 11:10:41,148 - root - INFO - 应用论文过滤器，论文ID: 1
2025-07-18 11:10:41,148 - root - INFO - 开始向量检索
2025-07-18 11:10:41,148 - root - INFO - Searching for documents with query: 这篇论文提出了什么核心创新？... (k=5)
2025-07-18 11:10:41,148 - root - INFO - Applying filter: {'paper_id': '1'}
2025-07-18 11:10:41,168 - httpx - INFO - HTTP Request: POST http://localhost:6333/collections/papers/points/search "HTTP/1.1 200 OK"
2025-07-18 11:10:41,171 - root - INFO - Found 5 matching documents
2025-07-18 11:10:41,171 - root - INFO - 向量检索完成，耗时: 0.02秒，找到文档数: 5
2025-07-18 11:10:41,171 - root - INFO - 开始LLM查询生成
2025-07-18 11:10:41,189 - httpx - INFO - HTTP Request: POST http://localhost:6333/collections/papers/points/search "HTTP/1.1 200 OK"
2025-07-18 11:10:42,721 - root - ERROR - 查询处理时出错: One input key expected got ['question', 'context', 'history']
Traceback (most recent call last):
  File "/Users/zhuolifeng/SE-Project/SE25Project-18-backend/python-rag-service/app/core/rag_engine.py", line 315, in query
    chain_result = await self.qa_chain.ainvoke({
  File "/Users/zhuolifeng/miniconda3/envs/dwp/lib/python3.10/site-packages/langchain/chains/base.py", line 218, in ainvoke
    raise e
  File "/Users/zhuolifeng/miniconda3/envs/dwp/lib/python3.10/site-packages/langchain/chains/base.py", line 213, in ainvoke
    final_outputs: dict[str, Any] = await self.aprep_outputs(
  File "/Users/zhuolifeng/miniconda3/envs/dwp/lib/python3.10/site-packages/langchain/chains/base.py", line 489, in aprep_outputs
    await self.memory.asave_context(inputs, outputs)
  File "/Users/zhuolifeng/miniconda3/envs/dwp/lib/python3.10/site-packages/langchain/memory/chat_memory.py", line 84, in asave_context
    input_str, output_str = self._get_input_output(inputs, outputs)
  File "/Users/zhuolifeng/miniconda3/envs/dwp/lib/python3.10/site-packages/langchain/memory/chat_memory.py", line 47, in _get_input_output
    prompt_input_key = get_prompt_input_key(inputs, self.memory_variables)
  File "/Users/zhuolifeng/miniconda3/envs/dwp/lib/python3.10/site-packages/langchain/memory/utils.py", line 19, in get_prompt_input_key
    raise ValueError(f"One input key expected got {prompt_input_keys}")
ValueError: One input key expected got ['question', 'context', 'history']
2025-07-18 11:12:53,964 - root - INFO - 正在初始化RAG服务...
2025-07-18 11:12:53,964 - app.core.rag_engine - INFO - Loading embedding model: sentence-transformers/all-MiniLM-L6-v2
2025-07-18 11:12:57,092 - sentence_transformers.SentenceTransformer - INFO - Load pretrained SentenceTransformer: sentence-transformers/all-MiniLM-L6-v2
2025-07-18 11:13:03,519 - app.core.rag_engine - INFO - 嵌入模型加载成功: sentence-transformers/all-MiniLM-L6-v2
2025-07-18 11:13:03,614 - httpx - INFO - HTTP Request: GET http://localhost:6333 "HTTP/1.1 200 OK"
2025-07-18 11:13:03,637 - httpx - INFO - HTTP Request: GET http://localhost:6333/collections "HTTP/1.1 200 OK"
2025-07-18 11:13:03,639 - app.core.vector_store - INFO - 向量存储初始化成功: qdrant
2025-07-18 11:13:03,639 - app.core.rag_engine - INFO - 向量存储初始化成功
2025-07-18 11:13:03,639 - app.core.rag_engine - INFO - LLM提供者初始化成功
2025-07-18 11:13:03,639 - app.core.rag_engine - INFO - Java后端客户端初始化成功: http://localhost:8080
2025-07-18 11:13:03,681 - app.core.llm_provider - INFO - Successfully initialized Qwen LLM with model: qwen-turbo
2025-07-18 11:13:03,681 - app.core.rag_engine - INFO - QA链创建成功
2025-07-18 11:13:03,682 - app.core.rag_engine - INFO - RAG引擎初始化完全成功
2025-07-18 11:13:03,682 - root - INFO - RAG引擎已成功设置到chat模块
2025-07-18 11:13:03,682 - root - INFO - RAG服务初始化完成并已设置到chat模块!
2025-07-18 11:13:46,939 - app.api.documents - INFO - Extracting PDF content for paper 1: Attention Is All You Need
2025-07-18 11:13:46,939 - root - INFO - PyPDF2库可用
2025-07-18 11:13:46,939 - root - INFO - pdfplumber库可用
2025-07-18 11:13:46,939 - root - INFO - Initialized PDFExtractor with chunk_size=1000, overlap=200
2025-07-18 11:13:46,940 - root - INFO - 开始处理PDF - URL: https://arxiv.org/pdf/1706.03762.pdf, 论文ID: 1, 标题: Attention Is All You Need
2025-07-18 11:13:46,940 - root - INFO - Searching for documents with query: paper_id_1... (k=1)
2025-07-18 11:13:46,940 - root - INFO - Special case - searching by paper_id: 1
2025-07-18 11:13:46,940 - root - INFO - Applying filter: {'paper_id': 1}
2025-07-18 11:13:47,062 - httpx - INFO - HTTP Request: POST http://localhost:6333/collections/papers/points/search "HTTP/1.1 200 OK"
2025-07-18 11:13:47,063 - root - INFO - Found 0 matching documents
2025-07-18 11:13:47,063 - root - INFO - 开始下载PDF: https://arxiv.org/pdf/1706.03762.pdf
2025-07-18 11:13:50,321 - root - INFO - PDF验证通过，开始提取文本
2025-07-18 11:13:51,825 - app.services.pdf_extractor - INFO - 使用pdfplumber成功提取了15页内容
2025-07-18 11:13:51,826 - app.services.pdf_extractor - INFO - 使用pdfplumber成功提取文本
2025-07-18 11:13:51,826 - root - INFO - 成功提取文本，大小: 35770 字符
2025-07-18 11:13:51,826 - app.services.pdf_extractor - INFO - 文本清理：原长度35756字符，清理后35756字符
2025-07-18 11:13:51,827 - app.services.pdf_extractor - INFO - 文本分割成45个块
2025-07-18 11:13:51,827 - root - INFO - 文本已分割成 45 个块
2025-07-18 11:13:51,827 - root - INFO - 开始将 45 个文本块存储到向量数据库
2025-07-18 11:13:51,827 - root - INFO - 准备存储 45 个文档到向量数据库
2025-07-18 11:13:52,981 - httpx - INFO - HTTP Request: PUT http://localhost:6333/collections/papers/points?wait=true "HTTP/1.1 200 OK"
2025-07-18 11:13:52,981 - app.core.vector_store - INFO - 成功添加 45 个文档到向量存储
2025-07-18 11:13:52,981 - root - INFO - 成功添加 45 个文档到向量数据库，返回的ID: ['86ce5e518758462e8b4c4af121615c4e', '0209869e3deb49a582af5397dfba5c62', '32edebb8b85e4770aa5e49d8e4ca05e4']...
2025-07-18 11:13:52,981 - root - INFO - 成功存储 45 个块到向量数据库，论文ID: 1
2025-07-18 11:14:04,835 - app.api.chat - INFO - Processing query: 这篇论文提出了什么核心创新？...
2025-07-18 11:14:04,835 - root - INFO - 处理查询 - 用户ID: 2, 论文ID: 1, 会话ID: test-conv-1
2025-07-18 11:14:04,835 - root - INFO - 查询问题: 这篇论文提出了什么核心创新？
2025-07-18 11:14:04,835 - root - INFO - 应用论文过滤器，论文ID: 1
2025-07-18 11:14:04,835 - root - INFO - 开始向量检索
2025-07-18 11:14:04,835 - root - INFO - Searching for documents with query: 这篇论文提出了什么核心创新？... (k=5)
2025-07-18 11:14:04,835 - root - INFO - Applying filter: {'paper_id': '1'}
2025-07-18 11:14:04,863 - httpx - INFO - HTTP Request: POST http://localhost:6333/collections/papers/points/search "HTTP/1.1 200 OK"
2025-07-18 11:14:04,863 - root - INFO - Found 5 matching documents
2025-07-18 11:14:04,864 - root - INFO - 向量检索完成，耗时: 0.03秒，找到文档数: 5
2025-07-18 11:14:04,864 - root - INFO - 开始LLM查询生成
2025-07-18 11:14:04,894 - httpx - INFO - HTTP Request: POST http://localhost:6333/collections/papers/points/search "HTTP/1.1 200 OK"
2025-07-18 11:14:07,844 - root - INFO - LLM生成完成，耗时: 2.98秒
2025-07-18 11:14:07,844 - root - INFO - 生成的回答长度: 210 字符
2025-07-18 11:28:24,525 - root - INFO - 正在初始化RAG服务...
2025-07-18 11:28:24,526 - app.core.rag_engine - INFO - Loading embedding model: sentence-transformers/all-MiniLM-L6-v2
2025-07-18 11:28:27,410 - sentence_transformers.SentenceTransformer - INFO - Load pretrained SentenceTransformer: sentence-transformers/all-MiniLM-L6-v2
2025-07-18 11:28:33,616 - app.core.rag_engine - INFO - 嵌入模型加载成功: sentence-transformers/all-MiniLM-L6-v2
2025-07-18 11:28:33,713 - httpx - INFO - HTTP Request: GET http://localhost:6333 "HTTP/1.1 200 OK"
2025-07-18 11:28:33,723 - httpx - INFO - HTTP Request: GET http://localhost:6333/collections "HTTP/1.1 200 OK"
2025-07-18 11:28:33,725 - app.core.vector_store - INFO - 向量存储初始化成功: qdrant
2025-07-18 11:28:33,725 - app.core.rag_engine - INFO - 向量存储初始化成功
2025-07-18 11:28:33,725 - app.core.rag_engine - INFO - LLM提供者初始化成功
2025-07-18 11:28:33,725 - app.core.rag_engine - INFO - Java后端客户端初始化成功: http://localhost:8080
2025-07-18 11:28:33,769 - app.core.llm_provider - INFO - Successfully initialized Qwen LLM with model: qwen-turbo
2025-07-18 11:28:33,769 - app.core.rag_engine - INFO - QA链创建成功
2025-07-18 11:28:33,769 - app.core.rag_engine - INFO - RAG引擎初始化完全成功
2025-07-18 11:28:33,770 - root - INFO - RAG引擎已成功设置到chat模块
2025-07-18 11:28:33,770 - root - INFO - RAG服务初始化完成并已设置到chat模块!
2025-07-18 11:28:56,032 - app.api.documents - INFO - Extracting PDF content for paper 1: Attention Is All You Need
2025-07-18 11:28:56,032 - root - INFO - PyPDF2库可用
2025-07-18 11:28:56,032 - root - INFO - pdfplumber库可用
2025-07-18 11:28:56,032 - root - INFO - Initialized PDFExtractor with chunk_size=1000, overlap=200
2025-07-18 11:28:56,032 - root - INFO - 开始处理PDF - URL: https://arxiv.org/pdf/1706.03762.pdf, 论文ID: 1, 标题: Attention Is All You Need
2025-07-18 11:28:56,032 - root - INFO - Searching for documents with query: paper_id_1... (k=1)
2025-07-18 11:28:56,032 - root - INFO - Special case - searching by paper_id: 1
2025-07-18 11:28:56,032 - root - INFO - Applying filter: {'paper_id': 1}
2025-07-18 11:28:56,161 - httpx - INFO - HTTP Request: POST http://localhost:6333/collections/papers/points/search "HTTP/1.1 200 OK"
2025-07-18 11:28:56,162 - root - INFO - Found 0 matching documents
2025-07-18 11:28:56,162 - root - INFO - 开始下载PDF: https://arxiv.org/pdf/1706.03762.pdf
2025-07-18 11:28:59,278 - root - INFO - PDF验证通过，开始提取文本
2025-07-18 11:29:00,797 - app.services.pdf_extractor - INFO - 使用pdfplumber成功提取了15页内容
2025-07-18 11:29:00,797 - app.services.pdf_extractor - INFO - 使用pdfplumber成功提取文本
2025-07-18 11:29:00,797 - root - INFO - 成功提取文本，大小: 35770 字符
2025-07-18 11:29:00,798 - app.services.pdf_extractor - INFO - 文本清理：原长度35756字符，清理后35756字符
2025-07-18 11:29:00,798 - app.services.pdf_extractor - INFO - 文本分割成45个块
2025-07-18 11:29:00,798 - root - INFO - 文本已分割成 45 个块
2025-07-18 11:29:00,798 - root - INFO - 开始将 45 个文本块存储到向量数据库
2025-07-18 11:29:00,799 - root - INFO - 准备存储 45 个文档到向量数据库
2025-07-18 11:29:01,578 - httpx - INFO - HTTP Request: PUT http://localhost:6333/collections/papers/points?wait=true "HTTP/1.1 200 OK"
2025-07-18 11:29:01,579 - app.core.vector_store - INFO - 成功添加 45 个文档到向量存储
2025-07-18 11:29:01,579 - root - INFO - 成功添加 45 个文档到向量数据库，返回的ID: ['1041526f8e1f45d1885a7a75cf92740f', 'a39db30bd7794ba8b7028ca406383f3c', '80b15a39c5df496a8a961e6e21ae767c']...
2025-07-18 11:29:01,579 - root - INFO - 成功存储 45 个块到向量数据库，论文ID: 1
2025-07-18 11:29:20,973 - app.api.chat - INFO - Processing query: 这篇论文提出了什么核心创新？...
2025-07-18 11:29:20,973 - root - INFO - 处理查询 - 用户ID: 2, 论文ID: 1, 会话ID: test-conv-1
2025-07-18 11:29:20,973 - root - INFO - 查询问题: 这篇论文提出了什么核心创新？
2025-07-18 11:29:20,973 - root - INFO - 应用论文过滤器，论文ID: 1
2025-07-18 11:29:20,973 - root - INFO - 开始向量检索
2025-07-18 11:29:20,973 - root - INFO - 开始向量检索
2025-07-18 11:29:20,973 - root - INFO - 概述性问题，增加检索量到 8
2025-07-18 11:29:20,973 - root - INFO - 应用论文过滤器，论文ID: 1
2025-07-18 11:29:20,973 - root - INFO - Searching for documents with query: 这篇论文提出了什么核心创新？... (k=8)
2025-07-18 11:29:20,973 - root - INFO - Applying filter: {'paper_id': '1'}
2025-07-18 11:29:20,997 - httpx - INFO - HTTP Request: POST http://localhost:6333/collections/papers/points/search "HTTP/1.1 200 OK"
2025-07-18 11:29:20,997 - root - INFO - Found 8 matching documents
2025-07-18 11:29:20,997 - root - INFO - 开始LLM查询生成
2025-07-18 11:29:21,017 - httpx - INFO - HTTP Request: POST http://localhost:6333/collections/papers/points/search "HTTP/1.1 200 OK"
2025-07-18 11:29:23,303 - root - INFO - LLM生成完成，耗时: 2.31秒
2025-07-18 11:29:23,304 - root - INFO - 生成的回答长度: 136 字符
2025-07-18 11:38:55,777 - root - INFO - 正在关闭RAG服务...
2025-07-18 11:38:55,778 - app.core.vector_store - INFO - 向量存储资源清理完成
2025-07-18 11:38:55,778 - root - INFO - RAG服务已关闭!
2025-07-18 11:38:59,744 - root - INFO - 正在初始化RAG服务...
2025-07-18 11:38:59,744 - app.core.rag_engine - INFO - Loading embedding model: sentence-transformers/all-MiniLM-L6-v2
2025-07-18 11:39:02,762 - sentence_transformers.SentenceTransformer - INFO - Load pretrained SentenceTransformer: sentence-transformers/all-MiniLM-L6-v2
2025-07-18 11:39:08,916 - app.core.rag_engine - INFO - 嵌入模型加载成功: sentence-transformers/all-MiniLM-L6-v2
2025-07-18 11:39:09,012 - httpx - INFO - HTTP Request: GET http://localhost:6333 "HTTP/1.1 200 OK"
2025-07-18 11:39:09,020 - httpx - INFO - HTTP Request: GET http://localhost:6333/collections "HTTP/1.1 200 OK"
2025-07-18 11:39:09,022 - app.core.vector_store - INFO - 向量存储初始化成功: qdrant
2025-07-18 11:39:09,022 - app.core.rag_engine - INFO - 向量存储初始化成功
2025-07-18 11:39:09,022 - app.core.rag_engine - INFO - LLM提供者初始化成功
2025-07-18 11:39:09,022 - app.core.rag_engine - INFO - Java后端客户端初始化成功: http://localhost:8080
2025-07-18 11:39:09,066 - app.core.llm_provider - INFO - Successfully initialized Qwen LLM with model: qwen-turbo
2025-07-18 11:39:09,067 - app.core.rag_engine - INFO - QA链创建成功
2025-07-18 11:39:09,067 - app.core.rag_engine - INFO - RAG引擎初始化完全成功
2025-07-18 11:39:09,067 - root - INFO - RAG引擎已成功设置到chat模块
2025-07-18 11:39:09,067 - root - INFO - RAG服务初始化完成并已设置到chat模块!
2025-07-18 11:42:05,847 - app.api.documents - INFO - Extracting PDF content for paper 1: Attention Is All You Need
2025-07-18 11:42:05,847 - root - INFO - PyPDF2库可用
2025-07-18 11:42:05,847 - root - INFO - pdfplumber库可用
2025-07-18 11:42:05,847 - root - INFO - Initialized PDFExtractor with chunk_size=1000, overlap=200
2025-07-18 11:42:05,847 - root - INFO - 开始处理PDF - URL: https://arxiv.org/pdf/1706.03762.pdf, 论文ID: 1, 标题: Attention Is All You Need
2025-07-18 11:42:05,847 - root - INFO - Searching for documents with query: paper_id_1... (k=1)
2025-07-18 11:42:05,847 - root - INFO - Special case - searching by paper_id: 1
2025-07-18 11:42:05,847 - root - INFO - Applying filter: {'paper_id': 1}
2025-07-18 11:42:05,982 - httpx - INFO - HTTP Request: POST http://localhost:6333/collections/papers/points/search "HTTP/1.1 200 OK"
2025-07-18 11:42:05,983 - root - INFO - Found 0 matching documents
2025-07-18 11:42:05,983 - root - INFO - 开始下载PDF: https://arxiv.org/pdf/1706.03762.pdf
2025-07-18 11:42:09,008 - root - INFO - PDF验证通过，开始提取文本
2025-07-18 11:42:10,512 - app.services.pdf_extractor - INFO - 使用pdfplumber成功提取了15页内容
2025-07-18 11:42:10,513 - app.services.pdf_extractor - WARNING - pdfplumber提取失败: 'PDFExtractor' object has no attribute '_mark_important_sections'
2025-07-18 11:42:11,006 - app.services.pdf_extractor - INFO - 使用PyPDF2成功提取了15页内容
2025-07-18 11:42:11,006 - app.services.pdf_extractor - INFO - 使用PyPDF2成功提取文本
2025-07-18 11:42:11,006 - root - INFO - 成功提取文本，大小: 39731 字符
2025-07-18 11:42:11,014 - app.services.pdf_extractor - INFO - 文本清理：原长度39962字符，清理后39962字符
2025-07-18 11:42:11,015 - app.services.pdf_extractor - INFO - 文本分割成52个块 (重要章节:0, 常规章节:52)
2025-07-18 11:42:11,015 - root - INFO - 文本已分割成 52 个块
2025-07-18 11:42:11,015 - root - INFO - 开始将 52 个文本块存储到向量数据库
2025-07-18 11:42:11,015 - root - INFO - 准备存储 52 个文档到向量数据库
2025-07-18 11:42:11,979 - httpx - INFO - HTTP Request: PUT http://localhost:6333/collections/papers/points?wait=true "HTTP/1.1 200 OK"
2025-07-18 11:42:11,980 - app.core.vector_store - INFO - 成功添加 52 个文档到向量存储
2025-07-18 11:42:11,980 - root - INFO - 成功添加 52 个文档到向量数据库，返回的ID: ['c24a6254cfba4e1bbea7df53fd940c38', 'da4a50a7c1ff4cdda90dcfc532bbfcb4', 'ff40a468eb4d46e5b1a2f67bc53e9db6']...
2025-07-18 11:42:11,981 - root - INFO - 成功存储 52 个块到向量数据库，论文ID: 1
2025-07-18 11:42:18,772 - app.api.chat - INFO - Processing query: 这篇论文提出了什么核心创新？...
2025-07-18 11:42:18,773 - root - INFO - 处理查询 - 用户ID: 2, 论文ID: 1, 会话ID: test-conv-1
2025-07-18 11:42:18,773 - root - INFO - 查询问题: 这篇论文提出了什么核心创新？
2025-07-18 11:42:18,773 - root - INFO - 应用论文过滤器，论文ID: 1
2025-07-18 11:42:18,774 - root - INFO - 开始向量检索
2025-07-18 11:42:18,774 - root - INFO - 开始向量检索
2025-07-18 11:42:18,774 - root - INFO - 概述性问题，增加检索量到 8
2025-07-18 11:42:18,774 - root - INFO - 应用论文过滤器，论文ID: 1
2025-07-18 11:42:18,774 - root - INFO - Searching for documents with query: 这篇论文提出了什么核心创新？... (k=8)
2025-07-18 11:42:18,775 - root - INFO - Applying filter: {'paper_id': '1'}
2025-07-18 11:42:18,818 - httpx - INFO - HTTP Request: POST http://localhost:6333/collections/papers/points/search "HTTP/1.1 200 OK"
2025-07-18 11:42:18,820 - root - INFO - Found 8 matching documents
2025-07-18 11:42:18,820 - root - INFO - 开始LLM查询生成
2025-07-18 11:42:18,848 - httpx - INFO - HTTP Request: POST http://localhost:6333/collections/papers/points/search "HTTP/1.1 200 OK"
2025-07-18 11:42:22,079 - root - INFO - LLM生成完成，耗时: 3.26秒
2025-07-18 11:42:22,080 - root - INFO - 生成的回答长度: 219 字符
2025-07-18 11:49:09,706 - app.api.chat - INFO - Processing query: 这篇论文提出了什么核心创新？...
2025-07-18 11:49:09,706 - root - INFO - 处理查询 - 用户ID: 2, 论文ID: 1, 会话ID: test-conv-1
2025-07-18 11:49:09,706 - root - INFO - 查询问题: 这篇论文提出了什么核心创新？
2025-07-18 11:49:09,706 - root - INFO - 应用论文过滤器，论文ID: 1
2025-07-18 11:49:09,706 - root - INFO - 开始向量检索
2025-07-18 11:49:09,706 - root - INFO - 开始向量检索
2025-07-18 11:49:09,706 - root - INFO - 概述性问题，增加检索量到 8
2025-07-18 11:49:09,706 - root - INFO - 应用论文过滤器，论文ID: 1
2025-07-18 11:49:09,706 - root - INFO - Searching for documents with query: 这篇论文提出了什么核心创新？... (k=8)
2025-07-18 11:49:09,706 - root - INFO - Applying filter: {'paper_id': '1'}
2025-07-18 11:49:09,747 - httpx - INFO - HTTP Request: POST http://localhost:6333/collections/papers/points/search "HTTP/1.1 200 OK"
2025-07-18 11:49:09,750 - root - INFO - Found 8 matching documents
2025-07-18 11:49:09,750 - root - INFO - 开始LLM查询生成
2025-07-18 11:49:10,332 - httpx - INFO - HTTP Request: POST http://localhost:6333/collections/papers/points/search "HTTP/1.1 200 OK"
2025-07-18 11:49:11,862 - root - INFO - LLM生成完成，耗时: 2.11秒
2025-07-18 11:49:11,863 - root - INFO - 生成的回答长度: 133 字符
2025-07-18 11:54:52,014 - root - INFO - 正在初始化RAG服务...
2025-07-18 11:54:52,015 - app.core.rag_engine - INFO - Loading embedding model: sentence-transformers/all-MiniLM-L6-v2
2025-07-18 11:54:54,988 - sentence_transformers.SentenceTransformer - INFO - Load pretrained SentenceTransformer: sentence-transformers/all-MiniLM-L6-v2
2025-07-18 11:55:01,211 - app.core.rag_engine - INFO - 嵌入模型加载成功: sentence-transformers/all-MiniLM-L6-v2
2025-07-18 11:55:01,290 - httpx - INFO - HTTP Request: GET http://localhost:6333 "HTTP/1.1 200 OK"
2025-07-18 11:55:01,298 - httpx - INFO - HTTP Request: GET http://localhost:6333/collections "HTTP/1.1 200 OK"
2025-07-18 11:55:01,299 - app.core.vector_store - INFO - 向量存储初始化成功: qdrant
2025-07-18 11:55:01,299 - app.core.rag_engine - INFO - 向量存储初始化成功
2025-07-18 11:55:01,299 - app.core.rag_engine - INFO - LLM提供者初始化成功
2025-07-18 11:55:01,299 - app.core.rag_engine - INFO - Java后端客户端初始化成功: http://localhost:8080
2025-07-18 11:55:01,343 - app.core.llm_provider - INFO - Successfully initialized Qwen LLM with model: qwen-turbo
2025-07-18 11:55:01,343 - app.core.rag_engine - INFO - QA链创建成功
2025-07-18 11:55:01,344 - app.core.rag_engine - INFO - RAG引擎初始化完全成功
2025-07-18 11:55:01,344 - root - INFO - RAG引擎已成功设置到chat模块
2025-07-18 11:55:01,344 - root - INFO - RAG服务初始化完成并已设置到chat模块!
2025-07-18 11:59:36,258 - app.api.documents - INFO - Extracting PDF content for paper 1: Attention Is All You Need
2025-07-18 11:59:36,258 - root - INFO - PyPDF2库可用
2025-07-18 11:59:36,258 - root - INFO - pdfplumber库可用
2025-07-18 11:59:36,258 - root - INFO - Initialized PDFExtractor with chunk_size=1000, overlap=200
2025-07-18 11:59:36,258 - root - INFO - 开始处理PDF - URL: https://arxiv.org/pdf/1706.03762.pdf, 论文ID: 1, 标题: Attention Is All You Need
2025-07-18 11:59:36,259 - root - INFO - Searching for documents with query: paper_id_1... (k=1)
2025-07-18 11:59:36,259 - root - INFO - Special case - searching by paper_id: 1
2025-07-18 11:59:36,259 - root - INFO - Applying filter: {'paper_id': 1}
2025-07-18 11:59:36,435 - httpx - INFO - HTTP Request: POST http://localhost:6333/collections/papers/points/search "HTTP/1.1 200 OK"
2025-07-18 11:59:36,436 - root - INFO - Found 0 matching documents
2025-07-18 11:59:36,436 - root - INFO - 开始下载PDF: https://arxiv.org/pdf/1706.03762.pdf
2025-07-18 11:59:39,557 - root - INFO - PDF验证通过，开始提取文本
2025-07-18 11:59:41,081 - app.services.pdf_extractor - INFO - 使用pdfplumber成功提取了15页内容
2025-07-18 11:59:41,081 - app.services.pdf_extractor - WARNING - pdfplumber提取失败: 'PDFExtractor' object has no attribute '_mark_important_sections'
2025-07-18 11:59:41,576 - app.services.pdf_extractor - INFO - 使用PyPDF2成功提取了15页内容
2025-07-18 11:59:41,576 - app.services.pdf_extractor - INFO - 使用PyPDF2成功提取文本
2025-07-18 11:59:41,576 - root - INFO - 成功提取文本，大小: 39731 字符
2025-07-18 11:59:41,584 - app.services.pdf_extractor - INFO - 文本清理：原长度39962字符，清理后39962字符
2025-07-18 11:59:41,585 - app.services.pdf_extractor - INFO - 文本分割成52个块 (重要章节:0, 常规章节:52)
2025-07-18 11:59:41,585 - root - INFO - 文本已分割成 52 个块
2025-07-18 11:59:41,585 - root - INFO - 开始将 52 个文本块存储到向量数据库
2025-07-18 11:59:41,585 - root - INFO - 准备存储 52 个文档到向量数据库
2025-07-18 11:59:42,559 - httpx - INFO - HTTP Request: PUT http://localhost:6333/collections/papers/points?wait=true "HTTP/1.1 200 OK"
2025-07-18 11:59:42,560 - app.core.vector_store - INFO - 成功添加 52 个文档到向量存储
2025-07-18 11:59:42,560 - root - INFO - 成功添加 52 个文档到向量数据库，返回的ID: ['fa1f847bc95444fb8d1566db49eb4957', '7aecc61661274c03877efc950e97920f', 'b7cbf7d4282d473e879b9f5ba86f3080']...
2025-07-18 11:59:42,560 - root - INFO - 成功存储 52 个块到向量数据库，论文ID: 1
2025-07-18 11:59:58,540 - app.api.chat - INFO - Processing query: 这篇论文提出了什么核心创新？...
2025-07-18 11:59:58,541 - root - INFO - 处理查询 - 用户ID: 2, 论文ID: 1, 会话ID: test-conv-1
2025-07-18 11:59:58,541 - root - INFO - 查询问题: 这篇论文提出了什么核心创新？
2025-07-18 11:59:58,541 - root - INFO - 应用论文过滤器，论文ID: 1
2025-07-18 11:59:58,541 - root - INFO - 开始向量检索
2025-07-18 11:59:58,541 - root - INFO - 开始向量检索
2025-07-18 11:59:58,541 - root - INFO - 概述性问题，增加检索量到 8
2025-07-18 11:59:58,541 - root - INFO - 应用论文过滤器，论文ID: 1
2025-07-18 11:59:58,541 - root - INFO - Searching for documents with query: 这篇论文提出了什么核心创新？... (k=8)
2025-07-18 11:59:58,541 - root - INFO - Applying filter: {'paper_id': '1'}
2025-07-18 11:59:58,585 - httpx - INFO - HTTP Request: POST http://localhost:6333/collections/papers/points/search "HTTP/1.1 200 OK"
2025-07-18 11:59:58,586 - root - INFO - Found 8 matching documents
2025-07-18 11:59:58,586 - root - INFO - 开始LLM查询生成
2025-07-18 11:59:58,606 - httpx - INFO - HTTP Request: POST http://localhost:6333/collections/papers/points/search "HTTP/1.1 200 OK"
2025-07-18 12:00:01,894 - root - INFO - LLM生成完成，耗时: 3.31秒
2025-07-18 12:00:01,895 - root - INFO - 生成的回答长度: 131 字符
2025-07-18 12:07:18,558 - root - INFO - 正在关闭RAG服务...
2025-07-18 12:07:18,562 - app.core.vector_store - INFO - 向量存储资源清理完成
2025-07-18 12:07:18,563 - root - INFO - RAG服务已关闭!
2025-07-18 12:07:22,066 - root - INFO - 正在初始化RAG服务...
2025-07-18 12:07:22,066 - app.core.rag_engine - INFO - Loading embedding model: sentence-transformers/all-MiniLM-L6-v2
2025-07-18 12:07:25,179 - sentence_transformers.SentenceTransformer - INFO - Load pretrained SentenceTransformer: sentence-transformers/all-MiniLM-L6-v2
2025-07-18 12:07:31,154 - app.core.rag_engine - INFO - 嵌入模型加载成功: sentence-transformers/all-MiniLM-L6-v2
2025-07-18 12:07:31,270 - httpx - INFO - HTTP Request: GET http://localhost:6333 "HTTP/1.1 200 OK"
2025-07-18 12:07:31,278 - httpx - INFO - HTTP Request: GET http://localhost:6333/collections "HTTP/1.1 200 OK"
2025-07-18 12:07:31,280 - app.core.vector_store - INFO - 向量存储初始化成功: qdrant
2025-07-18 12:07:31,280 - app.core.rag_engine - INFO - 向量存储初始化成功
2025-07-18 12:07:31,280 - app.core.rag_engine - INFO - LLM提供者初始化成功
2025-07-18 12:07:31,280 - app.core.rag_engine - INFO - Java后端客户端初始化成功: http://localhost:8080
2025-07-18 12:07:31,324 - app.core.llm_provider - INFO - Successfully initialized Qwen LLM with model: qwen-turbo
2025-07-18 12:07:31,324 - app.core.rag_engine - INFO - QA链创建成功
2025-07-18 12:07:31,324 - app.core.rag_engine - INFO - RAG引擎初始化完全成功
2025-07-18 12:07:31,324 - root - INFO - RAG引擎已成功设置到chat模块
2025-07-18 12:07:31,324 - root - INFO - RAG服务初始化完成并已设置到chat模块!
2025-07-18 12:07:45,081 - app.api.documents - INFO - Extracting PDF content for paper 1: Attention Is All You Need
2025-07-18 12:07:45,081 - root - INFO - PyPDF2库可用
2025-07-18 12:07:45,081 - root - INFO - pdfplumber库可用
2025-07-18 12:07:45,081 - root - INFO - Initialized PDFExtractor with chunk_size=1000, overlap=200
2025-07-18 12:07:45,081 - root - INFO - 开始处理PDF - URL: https://arxiv.org/pdf/1706.03762.pdf, 论文ID: 1, 标题: Attention Is All You Need
2025-07-18 12:07:45,081 - root - INFO - Searching for documents with query: paper_id_1... (k=1)
2025-07-18 12:07:45,081 - root - INFO - Special case - searching by paper_id: 1
2025-07-18 12:07:45,081 - root - INFO - Applying filter: {'paper_id': 1}
2025-07-18 12:07:45,252 - httpx - INFO - HTTP Request: POST http://localhost:6333/collections/papers/points/search "HTTP/1.1 200 OK"
2025-07-18 12:07:45,253 - root - INFO - Found 0 matching documents
2025-07-18 12:07:45,253 - root - INFO - 开始下载PDF: https://arxiv.org/pdf/1706.03762.pdf
2025-07-18 12:07:48,332 - root - INFO - PDF验证通过，开始提取文本
2025-07-18 12:07:48,333 - root - INFO - 开始从PDF提取文本...
2025-07-18 12:07:48,902 - app.services.pdf_extractor - INFO - 使用PyPDF2成功提取了15页内容
2025-07-18 12:07:48,902 - root - INFO - 使用PyPDF2成功提取文本
2025-07-18 12:07:48,902 - root - INFO - PDF文本提取完成，共39731字符
2025-07-18 12:07:48,902 - root - INFO - 成功提取文本，大小: 39731 字符
2025-07-18 12:07:48,920 - root - INFO - 开始将文本分割成块...
2025-07-18 12:07:48,926 - root - INFO - 文本分割完成，共生成42个块
2025-07-18 12:07:48,926 - root - INFO - 文本已分割成 42 个块
2025-07-18 12:07:48,926 - root - INFO - 开始将 42 个文本块存储到向量数据库
2025-07-18 12:07:48,926 - root - INFO - 开始将42个文本块存储到向量数据库...
2025-07-18 12:07:49,705 - httpx - INFO - HTTP Request: PUT http://localhost:6333/collections/papers/points?wait=true "HTTP/1.1 200 OK"
2025-07-18 12:07:49,705 - app.core.vector_store - INFO - 成功添加 42 个文档到向量存储
2025-07-18 12:07:49,705 - root - INFO - 成功存储 42 个块到向量数据库，论文ID: 1
2025-07-18 12:07:49,705 - root - INFO - 成功存储 42 个块到向量数据库，论文ID: 1
2025-07-18 12:07:59,573 - app.api.chat - INFO - Processing query: 这篇论文提出了什么核心创新？...
2025-07-18 12:07:59,574 - root - INFO - 处理查询 - 用户ID: 2, 论文ID: 1, 会话ID: test-conv-1
2025-07-18 12:07:59,574 - root - INFO - 查询问题: 这篇论文提出了什么核心创新？
2025-07-18 12:07:59,574 - root - INFO - 应用论文过滤器，论文ID: 1
2025-07-18 12:07:59,574 - root - INFO - 开始向量检索
2025-07-18 12:07:59,574 - root - INFO - 开始向量检索
2025-07-18 12:07:59,574 - root - INFO - 概述性问题，增加检索量到 8
2025-07-18 12:07:59,574 - root - INFO - 应用论文过滤器，论文ID: 1
2025-07-18 12:07:59,574 - root - INFO - Searching for documents with query: 这篇论文提出了什么核心创新？... (k=8)
2025-07-18 12:07:59,574 - root - INFO - Applying filter: {'paper_id': '1'}
2025-07-18 12:07:59,602 - httpx - INFO - HTTP Request: POST http://localhost:6333/collections/papers/points/search "HTTP/1.1 200 OK"
2025-07-18 12:07:59,602 - root - INFO - Found 8 matching documents
2025-07-18 12:07:59,602 - root - INFO - 开始LLM查询生成
2025-07-18 12:07:59,621 - httpx - INFO - HTTP Request: POST http://localhost:6333/collections/papers/points/search "HTTP/1.1 200 OK"
2025-07-18 12:08:01,733 - root - INFO - LLM生成完成，耗时: 2.13秒
2025-07-18 12:08:01,733 - root - INFO - 生成的回答长度: 133 字符
2025-07-18 12:11:30,046 - root - INFO - 正在关闭RAG服务...
2025-07-18 12:11:30,049 - app.core.vector_store - INFO - 向量存储资源清理完成
2025-07-18 12:11:30,049 - root - INFO - RAG服务已关闭!
2025-07-18 12:11:34,317 - root - INFO - 正在初始化RAG服务...
2025-07-18 12:11:34,318 - app.core.rag_engine - INFO - Loading embedding model: sentence-transformers/all-MiniLM-L6-v2
2025-07-18 12:11:37,216 - sentence_transformers.SentenceTransformer - INFO - Load pretrained SentenceTransformer: sentence-transformers/all-MiniLM-L6-v2
2025-07-18 12:11:44,105 - app.core.rag_engine - INFO - 嵌入模型加载成功: sentence-transformers/all-MiniLM-L6-v2
2025-07-18 12:11:44,176 - httpx - INFO - HTTP Request: GET http://localhost:6333 "HTTP/1.1 200 OK"
2025-07-18 12:11:44,183 - httpx - INFO - HTTP Request: GET http://localhost:6333/collections "HTTP/1.1 200 OK"
2025-07-18 12:11:44,304 - httpx - INFO - HTTP Request: PUT http://localhost:6333/collections/papers "HTTP/1.1 200 OK"
2025-07-18 12:11:44,305 - app.core.vector_store - INFO - 创建Qdrant集合: papers
2025-07-18 12:11:44,305 - app.core.vector_store - INFO - 向量存储初始化成功: qdrant
2025-07-18 12:11:44,305 - app.core.rag_engine - INFO - 向量存储初始化成功
2025-07-18 12:11:44,305 - app.core.rag_engine - INFO - LLM提供者初始化成功
2025-07-18 12:11:44,305 - app.core.rag_engine - INFO - Java后端客户端初始化成功: http://localhost:8080
2025-07-18 12:11:44,351 - app.core.llm_provider - INFO - Successfully initialized Qwen LLM with model: qwen-turbo
2025-07-18 12:11:44,351 - app.core.rag_engine - INFO - QA链创建成功
2025-07-18 12:11:44,351 - app.core.rag_engine - INFO - RAG引擎初始化完全成功
2025-07-18 12:11:44,351 - root - INFO - RAG引擎已成功设置到chat模块
2025-07-18 12:11:44,351 - root - INFO - RAG服务初始化完成并已设置到chat模块!
2025-07-18 12:12:46,475 - root - INFO - 正在关闭RAG服务...
2025-07-18 12:12:46,479 - app.core.vector_store - INFO - 向量存储资源清理完成
2025-07-18 12:12:46,479 - root - INFO - RAG服务已关闭!
2025-07-18 12:12:50,132 - root - INFO - 正在初始化RAG服务...
2025-07-18 12:12:50,132 - app.core.rag_engine - INFO - Loading embedding model: sentence-transformers/all-MiniLM-L6-v2
2025-07-18 12:12:53,156 - sentence_transformers.SentenceTransformer - INFO - Load pretrained SentenceTransformer: sentence-transformers/all-MiniLM-L6-v2
2025-07-18 12:12:59,285 - app.core.rag_engine - INFO - 嵌入模型加载成功: sentence-transformers/all-MiniLM-L6-v2
2025-07-18 12:12:59,382 - httpx - INFO - HTTP Request: GET http://localhost:6333 "HTTP/1.1 200 OK"
2025-07-18 12:12:59,391 - httpx - INFO - HTTP Request: GET http://localhost:6333/collections "HTTP/1.1 200 OK"
2025-07-18 12:12:59,393 - app.core.vector_store - INFO - 向量存储初始化成功: qdrant
2025-07-18 12:12:59,393 - app.core.rag_engine - INFO - 向量存储初始化成功
2025-07-18 12:12:59,393 - app.core.rag_engine - INFO - LLM提供者初始化成功
2025-07-18 12:12:59,393 - app.core.rag_engine - INFO - Java后端客户端初始化成功: http://localhost:8080
2025-07-18 12:12:59,438 - app.core.llm_provider - INFO - Successfully initialized Qwen LLM with model: qwen-turbo
2025-07-18 12:12:59,439 - app.core.rag_engine - INFO - QA链创建成功
2025-07-18 12:12:59,439 - app.core.rag_engine - INFO - RAG引擎初始化完全成功
2025-07-18 12:12:59,439 - root - INFO - RAG引擎已成功设置到chat模块
2025-07-18 12:12:59,439 - root - INFO - RAG服务初始化完成并已设置到chat模块!
2025-07-18 12:13:43,769 - app.api.documents - INFO - Extracting PDF content for paper 1: Attention Is All You Need
2025-07-18 12:13:43,771 - root - INFO - PyPDF2库可用
2025-07-18 12:13:43,771 - root - INFO - pdfplumber库可用
2025-07-18 12:13:43,771 - root - INFO - Initialized PDFExtractor with chunk_size=1000, overlap=200
2025-07-18 12:13:43,771 - root - INFO - 开始处理PDF - URL: https://arxiv.org/pdf/1706.03762.pdf, 论文ID: 1, 标题: Attention Is All You Need
2025-07-18 12:13:43,772 - root - INFO - Searching for documents with query: paper_id_1... (k=1)
2025-07-18 12:13:43,772 - root - INFO - Special case - searching by paper_id: 1
2025-07-18 12:13:43,772 - root - INFO - Applying filter: {'paper_id': 1}
2025-07-18 12:13:43,929 - httpx - INFO - HTTP Request: POST http://localhost:6333/collections/papers/points/search "HTTP/1.1 404 Not Found"
2025-07-18 12:13:43,930 - app.core.vector_store - ERROR - Qdrant搜索失败: Unexpected Response: 404 (Not Found)
Raw response content:
b'{"status":{"error":"Not found: Collection `papers` doesn\'t exist!"},"time":0.000031917}'
2025-07-18 12:13:43,930 - root - INFO - Found 0 matching documents
2025-07-18 12:13:43,930 - root - INFO - 开始下载PDF: https://arxiv.org/pdf/1706.03762.pdf
2025-07-18 12:13:47,069 - root - INFO - PDF验证通过，开始提取文本
2025-07-18 12:13:47,070 - root - INFO - 开始从PDF提取文本...
2025-07-18 12:13:47,689 - app.services.pdf_extractor - INFO - 使用PyPDF2成功提取了15页内容
2025-07-18 12:13:47,689 - root - INFO - 使用PyPDF2成功提取文本
2025-07-18 12:13:47,689 - root - INFO - PDF文本提取完成，共39731字符
2025-07-18 12:13:47,689 - root - INFO - 成功提取文本，大小: 39731 字符
2025-07-18 12:13:47,707 - root - INFO - 开始将文本分割成块...
2025-07-18 12:13:47,713 - root - INFO - 文本分割完成，共生成42个块
2025-07-18 12:13:47,713 - root - INFO - 文本已分割成 42 个块
2025-07-18 12:13:47,713 - root - INFO - 开始将 42 个文本块存储到向量数据库
2025-07-18 12:13:47,713 - root - INFO - 开始将42个文本块存储到向量数据库...
2025-07-18 12:13:48,509 - httpx - INFO - HTTP Request: PUT http://localhost:6333/collections/papers/points?wait=true "HTTP/1.1 404 Not Found"
2025-07-18 12:13:48,509 - app.core.vector_store - ERROR - 添加文档失败: Unexpected Response: 404 (Not Found)
Raw response content:
b'{"status":{"error":"Not found: Collection `papers` doesn\'t exist!"},"time":0.000062834}'
2025-07-18 12:13:48,509 - root - ERROR - 向量数据库存储失败: Unexpected Response: 404 (Not Found)
Raw response content:
b'{"status":{"error":"Not found: Collection `papers` doesn\'t exist!"},"time":0.000062834}'
2025-07-18 12:13:48,510 - root - INFO - 成功存储 0 个块到向量数据库，论文ID: 1
2025-07-18 12:23:42,269 - root - INFO - 正在关闭RAG服务...
2025-07-18 12:23:42,273 - app.core.vector_store - INFO - 向量存储资源清理完成
2025-07-18 12:23:42,273 - root - INFO - RAG服务已关闭!
2025-07-18 12:24:05,111 - root - INFO - 正在初始化RAG服务...
2025-07-18 12:24:05,111 - app.core.rag_engine - INFO - Loading embedding model: sentence-transformers/all-MiniLM-L6-v2
2025-07-18 12:24:08,456 - sentence_transformers.SentenceTransformer - INFO - Load pretrained SentenceTransformer: sentence-transformers/all-MiniLM-L6-v2
2025-07-18 12:24:14,551 - app.core.rag_engine - INFO - 嵌入模型加载成功: sentence-transformers/all-MiniLM-L6-v2
2025-07-18 12:24:14,552 - app.core.vector_store - ERROR - 向量存储初始化失败: VECTOR_STORE_TYPE
2025-07-18 12:24:14,552 - app.core.rag_engine - ERROR - 向量存储初始化失败: VECTOR_STORE_TYPE
2025-07-18 12:24:14,552 - app.core.rag_engine - ERROR - RAG引擎初始化严重失败: VECTOR_STORE_TYPE
2025-07-18 12:36:26,505 - root - INFO - 正在初始化RAG服务...
2025-07-18 12:36:26,505 - app.core.rag_engine - INFO - Loading embedding model: sentence-transformers/all-MiniLM-L6-v2
2025-07-18 12:36:29,895 - sentence_transformers.SentenceTransformer - INFO - Load pretrained SentenceTransformer: sentence-transformers/all-MiniLM-L6-v2
2025-07-18 12:36:36,235 - app.core.rag_engine - INFO - 嵌入模型加载成功: sentence-transformers/all-MiniLM-L6-v2
2025-07-18 12:36:36,241 - app.core.vector_store - INFO - 向量存储初始化成功: qdrant
2025-07-18 12:36:36,242 - app.core.rag_engine - ERROR - 向量存储初始化失败: object NoneType can't be used in 'await' expression
2025-07-18 12:36:36,242 - app.core.rag_engine - ERROR - RAG引擎初始化严重失败: object NoneType can't be used in 'await' expression
2025-07-18 12:39:26,064 - root - INFO - 正在初始化RAG服务...
2025-07-18 12:39:26,064 - app.core.rag_engine - INFO - Loading embedding model: sentence-transformers/all-MiniLM-L6-v2
2025-07-18 12:39:29,290 - sentence_transformers.SentenceTransformer - INFO - Load pretrained SentenceTransformer: sentence-transformers/all-MiniLM-L6-v2
2025-07-18 12:39:35,799 - app.core.rag_engine - INFO - 嵌入模型加载成功: sentence-transformers/all-MiniLM-L6-v2
2025-07-18 12:39:35,922 - httpx - INFO - HTTP Request: GET http://localhost:6333 "HTTP/1.1 200 OK"
2025-07-18 12:39:36,100 - httpx - INFO - HTTP Request: PUT http://localhost:6333/collections/papers "HTTP/1.1 200 OK"
2025-07-18 12:39:36,101 - app.core.vector_store - INFO - 创建了新的Qdrant集合: papers
2025-07-18 12:39:36,102 - app.core.vector_store - INFO - 向量存储初始化成功: qdrant
2025-07-18 12:39:36,102 - app.core.rag_engine - INFO - 向量存储初始化成功
2025-07-18 12:39:36,102 - app.core.rag_engine - INFO - LLM提供者初始化成功
2025-07-18 12:39:36,102 - app.core.rag_engine - INFO - Java后端客户端初始化成功: http://localhost:8080
2025-07-18 12:39:36,171 - app.core.llm_provider - INFO - Successfully initialized Qwen LLM with model: qwen-turbo
2025-07-18 12:39:36,172 - app.core.rag_engine - INFO - QA链创建成功
2025-07-18 12:39:36,172 - app.core.rag_engine - INFO - RAG引擎初始化完全成功
2025-07-18 12:39:36,172 - root - INFO - RAG引擎已成功设置到chat模块
2025-07-18 12:39:36,172 - root - INFO - RAG服务初始化完成并已设置到chat模块!
2025-07-18 12:39:48,061 - app.api.documents - INFO - Extracting PDF content for paper 1: Attention Is All You Need
2025-07-18 12:39:48,061 - root - INFO - PyPDF2库可用
2025-07-18 12:39:48,062 - root - INFO - pdfplumber库可用
2025-07-18 12:39:48,062 - root - INFO - Initialized PDFExtractor with chunk_size=1000, overlap=200
2025-07-18 12:39:48,062 - root - INFO - 开始处理PDF - URL: https://arxiv.org/pdf/1706.03762.pdf, 论文ID: 1, 标题: Attention Is All You Need
2025-07-18 12:39:48,062 - root - INFO - Searching for documents with query: paper_id_1... (k=1)
2025-07-18 12:39:48,062 - root - INFO - Special case - searching by paper_id: 1
2025-07-18 12:39:48,062 - root - INFO - Applying filter: {'paper_id': 1}
2025-07-18 12:39:48,237 - httpx - INFO - HTTP Request: POST http://localhost:6333/collections/papers/points/search "HTTP/1.1 200 OK"
2025-07-18 12:39:48,238 - root - INFO - Found 0 matching documents
2025-07-18 12:39:48,238 - root - INFO - 开始下载PDF: https://arxiv.org/pdf/1706.03762.pdf
2025-07-18 12:39:51,374 - root - INFO - PDF验证通过，开始提取文本
2025-07-18 12:39:51,374 - root - INFO - 开始从PDF提取文本...
2025-07-18 12:39:51,900 - app.services.pdf_extractor - INFO - 使用PyPDF2成功提取了15页内容
2025-07-18 12:39:51,900 - root - INFO - 使用PyPDF2成功提取文本
2025-07-18 12:39:51,900 - root - INFO - PDF文本提取完成，共39731字符
2025-07-18 12:39:51,900 - root - INFO - 成功提取文本，大小: 39731 字符
2025-07-18 12:39:51,917 - root - INFO - 开始将文本分割成块...
2025-07-18 12:39:51,923 - root - INFO - 文本分割完成，共生成42个块
2025-07-18 12:39:51,923 - root - INFO - 文本已分割成 42 个块
2025-07-18 12:39:51,923 - root - INFO - 开始将 42 个文本块存储到向量数据库
2025-07-18 12:39:51,923 - root - INFO - 开始将42个文本块存储到向量数据库...
2025-07-18 12:39:52,680 - httpx - INFO - HTTP Request: PUT http://localhost:6333/collections/papers/points?wait=true "HTTP/1.1 200 OK"
2025-07-18 12:39:52,691 - app.core.vector_store - INFO - 成功添加 42 个文档到向量存储
2025-07-18 12:39:52,691 - root - INFO - 成功存储 42 个块到向量数据库，论文ID: 1
2025-07-18 12:39:52,691 - root - INFO - 成功存储 42 个块到向量数据库，论文ID: 1
2025-07-18 12:40:07,790 - app.api.chat - INFO - Processing query: 这篇论文提出了什么核心创新？...
2025-07-18 12:40:07,790 - root - INFO - 处理查询 - 用户ID: 2, 论文ID: 1, 会话ID: test-conv-1
2025-07-18 12:40:07,790 - root - INFO - 查询问题: 这篇论文提出了什么核心创新？
2025-07-18 12:40:07,790 - root - INFO - 应用论文过滤器，论文ID: 1
2025-07-18 12:40:07,790 - root - INFO - 开始向量检索
2025-07-18 12:40:07,790 - root - INFO - 开始向量检索
2025-07-18 12:40:07,791 - root - INFO - 概述性问题，增加检索量到 8
2025-07-18 12:40:07,791 - root - INFO - 应用论文过滤器，论文ID: 1
2025-07-18 12:40:07,791 - root - INFO - Searching for documents with query: 这篇论文提出了什么核心创新？... (k=8)
2025-07-18 12:40:07,791 - root - INFO - Applying filter: {'paper_id': '1'}
2025-07-18 12:40:07,821 - httpx - INFO - HTTP Request: POST http://localhost:6333/collections/papers/points/search "HTTP/1.1 200 OK"
2025-07-18 12:40:07,824 - root - INFO - Found 8 matching documents
2025-07-18 12:40:07,824 - root - INFO - 开始LLM查询生成
2025-07-18 12:40:07,847 - httpx - INFO - HTTP Request: POST http://localhost:6333/collections/papers/points/search "HTTP/1.1 200 OK"
2025-07-18 12:40:16,788 - root - INFO - LLM生成完成，耗时: 8.96秒
2025-07-18 12:40:16,789 - root - INFO - 生成的回答长度: 474 字符
2025-07-18 12:41:41,151 - app.api.chat - INFO - Processing query: speak Chinese to tell me the contributions of the ...
2025-07-18 12:41:41,152 - root - INFO - 处理查询 - 用户ID: 1, 论文ID: None, 会话ID: 4c34a8e6-9bfb-4cdf-b8fd-7c09d2333137
2025-07-18 12:41:41,152 - root - INFO - 查询问题: speak Chinese to tell me the contributions of the paper
2025-07-18 12:41:41,152 - root - INFO - 开始向量检索
2025-07-18 12:41:41,152 - root - INFO - 开始向量检索
2025-07-18 12:41:41,152 - root - ERROR - 查询处理时出错: local variable 'docs' referenced before assignment
Traceback (most recent call last):
  File "/Users/zhuolifeng/SE-Project/SE25Project-18-backend/python-rag-service/app/core/rag_engine.py", line 449, in query
    logging.info(f"向量检索完成，耗时: {retrieval_time:.2f}秒，找到文档数: {len(docs)}")
UnboundLocalError: local variable 'docs' referenced before assignment
2025-07-18 12:44:09,317 - root - INFO - 正在初始化RAG服务...
2025-07-18 12:44:09,317 - app.core.rag_engine - INFO - Loading embedding model: sentence-transformers/all-MiniLM-L6-v2
2025-07-18 12:44:12,780 - sentence_transformers.SentenceTransformer - INFO - Load pretrained SentenceTransformer: sentence-transformers/all-MiniLM-L6-v2
2025-07-18 12:44:20,760 - app.core.rag_engine - INFO - 嵌入模型加载成功: sentence-transformers/all-MiniLM-L6-v2
2025-07-18 12:44:20,828 - httpx - INFO - HTTP Request: GET http://localhost:6333 "HTTP/1.1 200 OK"
2025-07-18 12:44:20,838 - httpx - INFO - HTTP Request: PUT http://localhost:6333/collections/papers "HTTP/1.1 409 Conflict"
2025-07-18 12:44:20,849 - app.core.vector_store - INFO - Qdrant集合 papers 已存在
2025-07-18 12:44:20,850 - app.core.vector_store - INFO - 向量存储初始化成功: qdrant
2025-07-18 12:44:20,850 - app.core.rag_engine - INFO - 向量存储初始化成功
2025-07-18 12:44:20,850 - app.core.rag_engine - INFO - LLM提供者初始化成功
2025-07-18 12:44:20,850 - app.core.rag_engine - INFO - Java后端客户端初始化成功: http://localhost:8080
2025-07-18 12:44:20,892 - app.core.llm_provider - INFO - Successfully initialized Qwen LLM with model: qwen-turbo
2025-07-18 12:44:20,893 - app.core.rag_engine - INFO - QA链创建成功
2025-07-18 12:44:20,893 - app.core.rag_engine - INFO - RAG引擎初始化完全成功
2025-07-18 12:44:20,893 - root - INFO - RAG引擎已成功设置到chat模块
2025-07-18 12:44:20,893 - root - INFO - RAG服务初始化完成并已设置到chat模块!
2025-07-18 12:45:27,686 - app.api.chat - INFO - Processing query: speak Chinese to tell me this paper...
2025-07-18 12:45:27,687 - root - INFO - 处理查询 - 用户ID: 1, 论文ID: None, 会话ID: f45fbd8b-d897-4467-b683-1b333a60a67c
2025-07-18 12:45:27,687 - root - INFO - 查询问题: speak Chinese to tell me this paper
2025-07-18 12:45:27,687 - root - INFO - 开始向量检索
2025-07-18 12:45:27,688 - root - INFO - 开始向量检索
2025-07-18 12:45:27,690 - root - ERROR - 查询处理时出错: local variable 'docs' referenced before assignment
Traceback (most recent call last):
  File "/Users/zhuolifeng/SE-Project/SE25Project-18-backend/python-rag-service/app/core/rag_engine.py", line 449, in query
    logging.info(f"向量检索完成，耗时: {retrieval_time:.2f}秒，找到文档数: {len(docs)}")
UnboundLocalError: local variable 'docs' referenced before assignment
2025-07-18 12:49:08,569 - root - INFO - 正在关闭RAG服务...
2025-07-18 12:49:08,572 - app.core.vector_store - INFO - 向量存储资源清理完成
2025-07-18 12:49:08,572 - root - INFO - RAG服务已关闭!
2025-07-18 12:49:12,201 - root - INFO - 正在初始化RAG服务...
2025-07-18 12:49:12,201 - app.core.rag_engine - INFO - Loading embedding model: sentence-transformers/all-MiniLM-L6-v2
2025-07-18 12:49:15,260 - sentence_transformers.SentenceTransformer - INFO - Load pretrained SentenceTransformer: sentence-transformers/all-MiniLM-L6-v2
2025-07-18 12:49:21,555 - app.core.rag_engine - INFO - 嵌入模型加载成功: sentence-transformers/all-MiniLM-L6-v2
2025-07-18 12:49:21,655 - httpx - INFO - HTTP Request: GET http://localhost:6333 "HTTP/1.1 200 OK"
2025-07-18 12:49:21,662 - httpx - INFO - HTTP Request: PUT http://localhost:6333/collections/papers "HTTP/1.1 409 Conflict"
2025-07-18 12:49:21,663 - app.core.vector_store - INFO - Qdrant集合 papers 已存在
2025-07-18 12:49:21,663 - app.core.vector_store - INFO - 向量存储初始化成功: qdrant
2025-07-18 12:49:21,663 - app.core.rag_engine - INFO - 向量存储初始化成功
2025-07-18 12:49:21,663 - app.core.rag_engine - INFO - LLM提供者初始化成功
2025-07-18 12:49:21,663 - app.core.rag_engine - INFO - Java后端客户端初始化成功: http://localhost:8080
2025-07-18 12:49:21,711 - app.core.llm_provider - INFO - Successfully initialized Qwen LLM with model: qwen-turbo
2025-07-18 12:49:21,712 - app.core.rag_engine - INFO - QA链创建成功
2025-07-18 12:49:21,712 - app.core.rag_engine - INFO - RAG引擎初始化完全成功
2025-07-18 12:49:21,712 - root - INFO - RAG引擎已成功设置到chat模块
2025-07-18 12:49:21,712 - root - INFO - RAG服务初始化完成并已设置到chat模块!
2025-07-18 12:49:46,166 - app.api.chat - INFO - Processing query: speak Chinese to tell me the contributions of the ...
2025-07-18 12:49:46,166 - root - INFO - 处理查询 - 用户ID: 1, 论文ID: None, 会话ID: fe25de98-6519-4c90-a09f-5291585f0926
2025-07-18 12:49:46,166 - root - INFO - 查询问题: speak Chinese to tell me the contributions of the paper
2025-07-18 12:49:46,166 - root - INFO - 开始向量检索
2025-07-18 12:49:46,166 - root - INFO - 开始向量检索
2025-07-18 12:49:46,167 - root - INFO - Searching for documents with query: speak Chinese to tell me the contributions of the ... (k=5)
2025-07-18 12:49:46,307 - httpx - INFO - HTTP Request: POST http://localhost:6333/collections/papers/points/search "HTTP/1.1 200 OK"
2025-07-18 12:49:46,309 - root - INFO - Found 5 matching documents
2025-07-18 12:49:46,309 - root - INFO - 向量检索完成，耗时: 0.14秒，找到文档数: 5
2025-07-18 12:49:46,309 - root - INFO - 开始LLM查询生成
2025-07-18 12:49:46,330 - httpx - INFO - HTTP Request: POST http://localhost:6333/collections/papers/points/search "HTTP/1.1 200 OK"
2025-07-18 12:49:56,484 - root - INFO - LLM生成完成，耗时: 10.17秒
2025-07-18 12:49:56,485 - root - INFO - 生成的回答长度: 786 字符
2025-07-18 12:50:04,108 - root - INFO - 正在关闭RAG服务...
2025-07-18 12:50:04,109 - app.core.vector_store - INFO - 向量存储资源清理完成
2025-07-18 12:50:04,109 - root - INFO - RAG服务已关闭!
2025-07-18 16:39:17,388 - root - INFO - 正在初始化RAG服务...
2025-07-18 16:39:17,388 - app.core.rag_engine - INFO - Loading embedding model: sentence-transformers/all-MiniLM-L6-v2
2025-07-18 16:39:21,585 - sentence_transformers.SentenceTransformer - INFO - Load pretrained SentenceTransformer: sentence-transformers/all-MiniLM-L6-v2
2025-07-18 16:39:28,428 - app.core.rag_engine - INFO - 嵌入模型加载成功: sentence-transformers/all-MiniLM-L6-v2
2025-07-18 16:39:28,566 - httpx - INFO - HTTP Request: GET http://localhost:6333 "HTTP/1.1 200 OK"
2025-07-18 16:39:28,585 - httpx - INFO - HTTP Request: PUT http://localhost:6333/collections/papers "HTTP/1.1 409 Conflict"
2025-07-18 16:39:28,586 - app.core.vector_store - INFO - Qdrant集合 papers 已存在
2025-07-18 16:39:28,586 - app.core.vector_store - INFO - 向量存储初始化成功: qdrant
2025-07-18 16:39:28,586 - app.core.rag_engine - INFO - 向量存储初始化成功
2025-07-18 16:39:28,586 - app.core.rag_engine - INFO - LLM提供者初始化成功
2025-07-18 16:39:28,586 - app.core.rag_engine - INFO - Java后端客户端初始化成功: http://localhost:8080
2025-07-18 16:39:28,633 - app.core.llm_provider - INFO - 成功初始化Qwen LLM，使用模型: qwen-turbo
2025-07-18 16:39:28,633 - app.core.rag_engine - INFO - QA链创建成功
2025-07-18 16:39:28,633 - app.core.rag_engine - INFO - RAG引擎初始化完全成功
2025-07-18 16:39:28,633 - root - INFO - RAG引擎已成功设置到chat模块
2025-07-18 16:39:28,634 - root - INFO - RAG服务初始化完成并已设置到chat模块!
2025-07-18 16:41:20,935 - app.api.chat - INFO - Processing query: speak Chinese to tell me the contributions of the ...
2025-07-18 16:41:20,936 - root - INFO - 处理查询 - 用户ID: 1, 论文ID: None, 会话ID: e8b5dded-49d2-4124-83b5-ff9d85ebf062
2025-07-18 16:41:20,936 - root - INFO - 查询问题: speak Chinese to tell me the contributions of the paper and what is its improvement over before papers
2025-07-18 16:41:20,936 - root - INFO - 开始向量检索
2025-07-18 16:41:20,936 - root - INFO - 开始向量检索
2025-07-18 16:41:20,938 - root - INFO - Searching for documents with query: speak Chinese to tell me the contributions of the ... (k=5)
2025-07-18 16:41:21,207 - httpx - INFO - HTTP Request: POST http://localhost:6333/collections/papers/points/search "HTTP/1.1 200 OK"
2025-07-18 16:41:21,210 - root - INFO - Found 5 matching documents
2025-07-18 16:41:21,211 - root - INFO - 向量检索完成，耗时: 0.27秒，找到文档数: 5
2025-07-18 16:41:21,211 - root - INFO - 开始LLM查询生成
2025-07-18 16:41:21,248 - httpx - INFO - HTTP Request: POST http://localhost:6333/collections/papers/points/search "HTTP/1.1 200 OK"
2025-07-18 16:41:29,601 - root - INFO - LLM生成完成，耗时: 8.39秒
2025-07-18 16:41:29,601 - root - INFO - 生成的回答长度: 523 字符
2025-07-18 16:43:20,784 - root - INFO - 正在关闭RAG服务...
2025-07-18 16:43:20,786 - app.core.vector_store - INFO - 向量存储资源清理完成
2025-07-18 16:43:20,786 - root - INFO - RAG服务已关闭!
2025-07-18 16:43:46,612 - root - INFO - 正在初始化RAG服务...
2025-07-18 16:43:46,612 - app.core.rag_engine - INFO - Loading embedding model: sentence-transformers/all-MiniLM-L6-v2
2025-07-18 16:43:49,897 - sentence_transformers.SentenceTransformer - INFO - Load pretrained SentenceTransformer: sentence-transformers/all-MiniLM-L6-v2
2025-07-18 16:43:56,607 - app.core.rag_engine - INFO - 嵌入模型加载成功: sentence-transformers/all-MiniLM-L6-v2
2025-07-18 16:43:56,704 - httpx - INFO - HTTP Request: GET http://localhost:6333 "HTTP/1.1 200 OK"
2025-07-18 16:43:56,715 - httpx - INFO - HTTP Request: PUT http://localhost:6333/collections/papers "HTTP/1.1 409 Conflict"
2025-07-18 16:43:56,716 - app.core.vector_store - INFO - Qdrant集合 papers 已存在
2025-07-18 16:43:56,716 - app.core.vector_store - INFO - 向量存储初始化成功: qdrant
2025-07-18 16:43:56,716 - app.core.rag_engine - INFO - 向量存储初始化成功
2025-07-18 16:43:56,716 - app.core.rag_engine - INFO - LLM提供者初始化成功
2025-07-18 16:43:56,716 - app.core.rag_engine - INFO - Java后端客户端初始化成功: http://localhost:8080
2025-07-18 16:43:56,725 - app.core.llm_provider - INFO - 准备初始化Ollama LLM，使用模型: qwen2.5-math, URL: http://localhost:11434
2025-07-18 16:43:56,725 - app.core.llm_provider - INFO - 检查Ollama服务器连接: http://localhost:11434
2025-07-18 16:43:56,739 - app.core.llm_provider - INFO - Ollama服务器连接成功，版本: 0.9.3
2025-07-18 16:43:56,789 - app.core.llm_provider - WARNING - 模型 'qwen2.5-math' 在Ollama服务器上不可用
2025-07-18 16:43:56,789 - app.core.llm_provider - INFO - 可用模型: qwen2.5-math:latest, qwen25vl-tuned:latest, qwen2.5vl:latest, qwen2.5vl:7b, qwen25vl_safetensors:latest, qwen25vl_new:latest, qwen25vl_test:latest, qwen2.5:7b-instruct, qwen25vl-custom-f32:latest, qwen25vl-custom:latest, llava:latest, qwen2.5:latest, llama2:latest, llava:34b, llama3.1:8b, llama3.2:1b, llama3.2-vision:11b, llama3.2:latest, llama3.3:latest, llama3.1:latest, llama3.2-vision:latest
2025-07-18 16:43:56,789 - app.core.llm_provider - WARNING - 模型 'qwen2.5-math' 可能不可用，但仍将尝试使用
2025-07-18 16:43:56,790 - app.core.llm_provider - INFO - 成功初始化Ollama LLM，使用模型: qwen2.5-math
2025-07-18 16:43:56,790 - app.core.rag_engine - INFO - QA链创建成功
2025-07-18 16:43:56,790 - app.core.rag_engine - INFO - RAG引擎初始化完全成功
2025-07-18 16:43:56,791 - root - INFO - RAG引擎已成功设置到chat模块
2025-07-18 16:43:56,791 - root - INFO - RAG服务初始化完成并已设置到chat模块!
2025-07-18 16:45:03,363 - app.api.chat - INFO - Processing query: speak Chinese to tell me the contributions of this...
2025-07-18 16:45:03,363 - root - INFO - 处理查询 - 用户ID: 1, 论文ID: None, 会话ID: 5c67fa9a-7948-4399-9ede-efc50f462e99
2025-07-18 16:45:03,363 - root - INFO - 查询问题: speak Chinese to tell me the contributions of this paper and what is the improvement over before papers
2025-07-18 16:45:03,363 - root - INFO - 开始向量检索
2025-07-18 16:45:03,363 - root - INFO - 开始向量检索
2025-07-18 16:45:03,364 - root - INFO - Searching for documents with query: speak Chinese to tell me the contributions of this... (k=5)
2025-07-18 16:45:03,563 - httpx - INFO - HTTP Request: POST http://localhost:6333/collections/papers/points/search "HTTP/1.1 200 OK"
2025-07-18 16:45:03,568 - root - INFO - Found 5 matching documents
2025-07-18 16:45:03,568 - root - INFO - 向量检索完成，耗时: 0.20秒，找到文档数: 5
2025-07-18 16:45:03,568 - root - INFO - 开始LLM查询生成
2025-07-18 16:45:03,612 - httpx - INFO - HTTP Request: POST http://localhost:6333/collections/papers/points/search "HTTP/1.1 200 OK"
2025-07-18 16:47:04,303 - root - ERROR - 向量检索或LLM处理过程中出错: 
2025-07-18 16:48:23,232 - root - INFO - 正在初始化RAG服务...
2025-07-18 16:48:23,232 - app.core.rag_engine - INFO - Loading embedding model: sentence-transformers/all-MiniLM-L6-v2
2025-07-18 16:48:26,232 - sentence_transformers.SentenceTransformer - INFO - Load pretrained SentenceTransformer: sentence-transformers/all-MiniLM-L6-v2
2025-07-18 16:48:32,865 - app.core.rag_engine - INFO - 嵌入模型加载成功: sentence-transformers/all-MiniLM-L6-v2
2025-07-18 16:48:32,946 - httpx - INFO - HTTP Request: GET http://localhost:6333 "HTTP/1.1 200 OK"
2025-07-18 16:48:32,952 - httpx - INFO - HTTP Request: PUT http://localhost:6333/collections/papers "HTTP/1.1 409 Conflict"
2025-07-18 16:48:32,953 - app.core.vector_store - INFO - Qdrant集合 papers 已存在
2025-07-18 16:48:32,953 - app.core.vector_store - INFO - 向量存储初始化成功: qdrant
2025-07-18 16:48:32,953 - app.core.rag_engine - INFO - 向量存储初始化成功
2025-07-18 16:48:32,953 - app.core.rag_engine - INFO - LLM提供者初始化成功
2025-07-18 16:48:32,953 - app.core.rag_engine - INFO - Java后端客户端初始化成功: http://localhost:8080
2025-07-18 16:48:32,961 - app.core.llm_provider - INFO - 准备初始化Ollama LLM，使用模型: qwen2.5-math:latest, URL: http://localhost:11434
2025-07-18 16:48:32,961 - app.core.llm_provider - INFO - 检查Ollama服务器连接: http://localhost:11434
2025-07-18 16:48:32,974 - app.core.llm_provider - INFO - Ollama服务器连接成功，版本: 0.9.3
2025-07-18 16:48:33,023 - app.core.llm_provider - INFO - 模型 'qwen2.5-math:latest' 在Ollama服务器上可用
2025-07-18 16:48:33,024 - app.core.llm_provider - INFO - 成功初始化Ollama LLM，使用模型: qwen2.5-math:latest
2025-07-18 16:48:33,025 - app.core.rag_engine - INFO - QA链创建成功
2025-07-18 16:48:33,025 - app.core.rag_engine - INFO - RAG引擎初始化完全成功
2025-07-18 16:48:33,025 - root - INFO - RAG引擎已成功设置到chat模块
2025-07-18 16:48:33,025 - root - INFO - RAG服务初始化完成并已设置到chat模块!
2025-07-18 16:49:11,077 - app.api.chat - INFO - Processing query: speak Chinese to tell me the contributions of the ...
2025-07-18 16:49:11,083 - root - INFO - 处理查询 - 用户ID: 1, 论文ID: None, 会话ID: 6ae68e46-25c4-4158-8a57-5dd56520573b
2025-07-18 16:49:11,083 - root - INFO - 查询问题: speak Chinese to tell me the contributions of the paper and what is the improvement over before papers
2025-07-18 16:49:11,083 - root - INFO - 开始向量检索
2025-07-18 16:49:11,083 - root - INFO - 开始向量检索
2025-07-18 16:49:11,090 - root - INFO - Searching for documents with query: speak Chinese to tell me the contributions of the ... (k=5)
2025-07-18 16:49:11,235 - httpx - INFO - HTTP Request: POST http://localhost:6333/collections/papers/points/search "HTTP/1.1 200 OK"
2025-07-18 16:49:11,237 - root - INFO - Found 5 matching documents
2025-07-18 16:49:11,237 - root - INFO - 向量检索完成，耗时: 0.15秒，找到文档数: 5
2025-07-18 16:49:11,237 - root - INFO - 开始LLM查询生成
2025-07-18 16:49:11,271 - httpx - INFO - HTTP Request: POST http://localhost:6333/collections/papers/points/search "HTTP/1.1 200 OK"
2025-07-18 16:51:11,298 - root - ERROR - 向量检索或LLM处理过程中出错: 
2025-07-18 16:57:39,972 - root - INFO - 正在关闭RAG服务...
2025-07-18 16:57:39,974 - app.core.vector_store - INFO - 向量存储资源清理完成
2025-07-18 16:57:39,975 - root - INFO - RAG服务已关闭!
2025-07-18 16:57:43,995 - root - INFO - 正在初始化RAG服务...
2025-07-18 16:57:43,995 - app.core.rag_engine - INFO - Loading embedding model: sentence-transformers/all-MiniLM-L6-v2
2025-07-18 16:57:47,124 - sentence_transformers.SentenceTransformer - INFO - Load pretrained SentenceTransformer: sentence-transformers/all-MiniLM-L6-v2
2025-07-18 16:57:54,008 - app.core.rag_engine - INFO - 嵌入模型加载成功: sentence-transformers/all-MiniLM-L6-v2
2025-07-18 16:57:54,103 - httpx - INFO - HTTP Request: GET http://localhost:6333 "HTTP/1.1 200 OK"
2025-07-18 16:57:54,111 - httpx - INFO - HTTP Request: PUT http://localhost:6333/collections/papers "HTTP/1.1 409 Conflict"
2025-07-18 16:57:54,111 - app.core.vector_store - INFO - Qdrant集合 papers 已存在
2025-07-18 16:57:54,111 - app.core.vector_store - INFO - 向量存储初始化成功: qdrant
2025-07-18 16:57:54,111 - app.core.rag_engine - INFO - 向量存储初始化成功
2025-07-18 16:57:54,111 - app.core.rag_engine - INFO - LLM提供者初始化成功
2025-07-18 16:57:54,111 - app.core.rag_engine - INFO - Java后端客户端初始化成功: http://localhost:8080
2025-07-18 16:57:54,183 - app.core.llm_provider - INFO - 成功初始化Ollama LLM，使用模型: qwen2.5-math:latest
2025-07-18 16:57:54,183 - app.core.rag_engine - INFO - QA链创建成功
2025-07-18 16:57:54,183 - app.core.rag_engine - INFO - RAG引擎初始化完全成功
2025-07-18 16:57:54,183 - root - INFO - RAG引擎已成功设置到chat模块
2025-07-18 16:57:54,183 - root - INFO - RAG服务初始化完成并已设置到chat模块!
2025-07-18 16:58:13,901 - app.api.chat - INFO - Processing query: speak Chinese to tell me the contributions of the ...
2025-07-18 16:58:13,902 - root - INFO - 处理查询 - 用户ID: 1, 论文ID: None, 会话ID: 79a01159-25d6-4d39-ac1e-eefa03c43be2
2025-07-18 16:58:13,902 - root - INFO - 查询问题: speak Chinese to tell me the contributions of the paper and what is the improvement over before papers
2025-07-18 16:58:13,902 - root - INFO - 开始向量检索
2025-07-18 16:58:13,902 - root - INFO - 开始向量检索
2025-07-18 16:58:13,903 - root - INFO - Searching for documents with query: speak Chinese to tell me the contributions of the ... (k=3)
2025-07-18 16:58:14,182 - httpx - INFO - HTTP Request: POST http://localhost:6333/collections/papers/points/search "HTTP/1.1 200 OK"
2025-07-18 16:58:14,184 - root - INFO - Found 3 matching documents
2025-07-18 16:58:14,184 - root - INFO - 向量检索完成，耗时: 0.28秒，找到文档数: 3
2025-07-18 16:58:14,184 - root - INFO - 开始LLM查询生成
2025-07-18 16:58:14,221 - httpx - INFO - HTTP Request: POST http://localhost:6333/collections/papers/points/search "HTTP/1.1 200 OK"
2025-07-18 17:01:32,466 - httpx - INFO - HTTP Request: POST http://localhost:11434/api/generate "HTTP/1.1 200 OK"
2025-07-18 17:02:02,177 - root - INFO - LLM生成完成，耗时: 227.99秒
2025-07-18 17:02:02,178 - root - INFO - 生成的回答长度: 276 字符
2025-07-18 17:02:02,180 - root - INFO - Request processed in 228.28 seconds: /api/chat/query
2025-07-18 17:02:22,696 - root - INFO - 正在关闭RAG服务...
2025-07-18 17:02:22,697 - app.core.vector_store - INFO - 向量存储资源清理完成
2025-07-18 17:02:22,697 - root - INFO - RAG服务已关闭!
2025-07-18 17:02:26,592 - root - INFO - 正在初始化RAG服务...
2025-07-18 17:02:26,592 - app.core.rag_engine - INFO - Loading embedding model: sentence-transformers/all-MiniLM-L6-v2
2025-07-18 17:02:30,015 - sentence_transformers.SentenceTransformer - INFO - Load pretrained SentenceTransformer: sentence-transformers/all-MiniLM-L6-v2
2025-07-18 17:02:36,914 - app.core.rag_engine - INFO - 嵌入模型加载成功: sentence-transformers/all-MiniLM-L6-v2
2025-07-18 17:02:37,030 - httpx - INFO - HTTP Request: GET http://localhost:6333 "HTTP/1.1 200 OK"
2025-07-18 17:02:37,038 - httpx - INFO - HTTP Request: PUT http://localhost:6333/collections/papers "HTTP/1.1 409 Conflict"
2025-07-18 17:02:37,038 - app.core.vector_store - INFO - Qdrant集合 papers 已存在
2025-07-18 17:02:37,039 - app.core.vector_store - INFO - 向量存储初始化成功: qdrant
2025-07-18 17:02:37,039 - app.core.rag_engine - INFO - 向量存储初始化成功
2025-07-18 17:02:37,039 - app.core.rag_engine - INFO - LLM提供者初始化成功
2025-07-18 17:02:37,039 - app.core.rag_engine - INFO - Java后端客户端初始化成功: http://localhost:8080
2025-07-18 17:02:37,115 - app.core.llm_provider - INFO - 成功初始化Ollama LLM，使用模型: qwen2.5-math:latest
2025-07-18 17:02:37,115 - app.core.rag_engine - INFO - QA链创建成功
2025-07-18 17:02:37,115 - app.core.rag_engine - INFO - RAG引擎初始化完全成功
2025-07-18 17:02:37,115 - root - INFO - RAG引擎已成功设置到chat模块
2025-07-18 17:02:37,116 - root - INFO - RAG服务初始化完成并已设置到chat模块!
2025-07-18 17:02:48,312 - app.api.chat - INFO - Processing query: speak Chinese to tell me the contributions of the ...
2025-07-18 17:02:48,312 - root - INFO - 处理查询 - 用户ID: 1, 论文ID: None, 会话ID: c6f66b94-21bd-46ed-861b-8c0141a33aac
2025-07-18 17:02:48,312 - root - INFO - 查询问题: speak Chinese to tell me the contributions of the paper and what is the improvement over before papers
2025-07-18 17:02:48,312 - root - INFO - 开始向量检索
2025-07-18 17:02:48,312 - root - INFO - 开始向量检索
2025-07-18 17:02:48,313 - root - INFO - Searching for documents with query: speak Chinese to tell me the contributions of the ... (k=3)
2025-07-18 17:02:48,823 - httpx - INFO - HTTP Request: POST http://localhost:6333/collections/papers/points/search "HTTP/1.1 200 OK"
2025-07-18 17:02:48,826 - root - INFO - Found 3 matching documents
2025-07-18 17:02:48,826 - root - INFO - 向量检索完成，耗时: 0.51秒，找到文档数: 3
2025-07-18 17:02:48,826 - root - INFO - 开始LLM查询生成
2025-07-18 17:02:48,860 - httpx - INFO - HTTP Request: POST http://localhost:6333/collections/papers/points/search "HTTP/1.1 200 OK"
2025-07-18 17:02:49,595 - httpx - INFO - HTTP Request: POST http://localhost:11434/api/generate "HTTP/1.1 200 OK"
2025-07-18 17:03:19,258 - root - INFO - LLM生成完成，耗时: 30.43秒
2025-07-18 17:03:19,259 - root - INFO - 生成的回答长度: 250 字符
2025-07-18 17:03:19,261 - root - INFO - Request processed in 30.95 seconds: /api/chat/query
